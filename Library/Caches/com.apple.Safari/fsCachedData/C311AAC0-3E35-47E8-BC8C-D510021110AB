var $body=$(document.body);var _$tweet_carousel=$(".tweet_carousel"),_$tweet_carousel_container=$(".tweet_carousel_container"),_$tweet_section=$("#tweets"),_tweet_advance_interval=false,_TWEET_ADVANCE_PERIOD_MS=5e3,_NUMBER_OF_TWEETS=$(".tweet_carousel li").length;var _$screenshots=$("#screenshots"),_header_carousel_active=true,_header_advance_interval=false,_HEADER_ADVANCE_PERIOD_MS=5e3;var _$ways_container=$("#communicate"),_ways_advance_interval=false,_WAYS_ADVANCE_PERIOD_MS=5e3;var _SCROLL_FIXED_CUTOFF=_SCROLL_FIXED_CUTOFF||($(window).height()>=825?300:75),_HEADER_HEIGHT=_HEADER_HEIGHT||825;var _EXPERIMENT_ID=17;var _HAS_STORY=_HAS_STORY;var _FROM_SUBDOMAIN=_FROM_SUBDOMAIN;if($body.scrollTop()>=_SCROLL_FIXED_CUTOFF){_header_carousel_active=false;if(!$body.hasClass("scrolled")){$body.addClass("scrolled")}}$(window).scroll(function(e){if(this.pageYOffset>=_SCROLL_FIXED_CUTOFF&&!$body.hasClass("scrolled")){$body.addClass("scrolled")}else if(this.pageYOffset<_SCROLL_FIXED_CUTOFF&&$body.hasClass("scrolled")){$body.removeClass("scrolled")}if(this.pageYOffset>=_HEADER_HEIGHT){_header_carousel_active=false}else{_header_carousel_active=true}});$(window).load(function(){$("nav.mobile_menu").removeClass("loading");$("[data-srcset]").each(function(i){$(this).attr("srcset",$(this).attr("data-srcset"))});$("[data-src]").each(function(i){$(this).attr("src",$(this).attr("data-src"))});$("[data-defer-bg]").each(function(i){$(this).removeAttr("data-defer-bg")});if(_$tweet_carousel.length)_startTweetAutoAdvance();if(_$screenshots.length)_startHeaderAutoAdvance();if(_$ways_container.length)_startWaysAutoAdvance();$("#story_scroll").on("click",function(){var animate_to;if($(".top_ad_header_mobile").length>0&&$(window).width()<=640){animate_to=$(".top_ad_header_mobile")}else if($("header").length>0){animate_to=$("header")}else{animate_to=$("#page")}$("html, body").animate({scrollTop:animate_to.offset().top-$("nav.top").height()},250)});setTimeout(function(){if(_getQueryVariable("reset_cookie")==="1"){landing.resetCookie();eraseCookie("lp_nt",".slack.com")}else if(_getQueryVariable("story")==="marsandbeyond"){history.replaceState({},"story","/")}else if(_getQueryVariable("story")==="openforbusiness"){history.replaceState({},"story","/")}else if(_getQueryVariable("story")==="neutrinoinahaystack"){history.replaceState({},"story","/")}else if(_getQueryVariable("r")==="1"){history.replaceState({},"r","/")}},bowser.msie?200:0);if(landing.perf_beacon_prefix){TSMeasureAndBeacon(landing.perf_beacon_prefix+"_load","start_load");TSMeasureAndBeacon(landing.perf_beacon_prefix+"_total_load","start_nav")}});$("nav .mobile_menu_btn, nav.mobile_menu .close").click(function(e){e.preventDefault();$("body").toggleClass("show_mobile_nav")});$("#screenshots .switcher a").click(function(e){e.preventDefault();e.stopPropagation();_stopHeaderAutoAdvance();$("#screenshots").attr("data-highlight",$(this).data("highlight"))});$("#screenshots").click(function(){_stopHeaderAutoAdvance();_moveHeaderCarouselRight()});$(document).keydown(function(e){if(!_header_carousel_active)return;switch(e.which){case 37:_stopHeaderAutoAdvance();_moveHeaderCarouselLeft();break;case 39:_stopHeaderAutoAdvance();_moveHeaderCarouselRight();break}});$("#tweets").find(".tweet_carousel_controls a").on("click",function(e){e.preventDefault();_stopTweetAutoAdvance();var action=$(e.currentTarget).data("action");switch(action){case"left":return _moveTweetAnimationLeft();case"right":return _moveTweetAnimationRight()}});$("#communicate .way").click(function(e){if($(document).width()<=945)return;e.stopPropagation();_stopWaysAutoAdvance();$("#communicate").attr("data-highlight",$(this).data("highlight"))});$("#communicate .switcher a").click(function(e){e.preventDefault();e.stopPropagation();_stopWaysAutoAdvance();$("#communicate").attr("data-highlight",$(this).data("highlight"))});$("#communicate").click(function(e){_stopWaysAutoAdvance();_moveWaysForward()});$(".cta_track").on("click",function(e){e.preventDefault();var _form=$(this).append('<form id="cta_submit" action="'+landing.root_url+'create" method="post" type="hidden"></form>');var $form=$("#cta_submit");_initExperimentCombi($form);$form.submit()});$(".cta_form").on("submit",function(e){var email_regex=new RegExp("^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$","i");var $email=$(".input_email",$(this));var email_str=$.trim($email.val());if(!email_str||!email_regex.test(email_str)){e.preventDefault();$email.parent().addClass("error");$email.prev("label").highlightText();return}_initExperimentCombi($(this))});function _initExperimentCombi(form){var type=readCookie("_vis_opt_exp_"+_EXPERIMENT_ID+"_combi")!==null?"combi":"split";var combi_num=readCookie("_vis_opt_exp_"+_EXPERIMENT_ID+"_"+type)||"DEV";form.append('<input name="experiment_id" type="hidden" value='+_EXPERIMENT_ID+">");form.append('<input name="combi_num" type="hidden" value='+combi_num+">")}function _moveTweetAnimationLeft(){_$tweet_section.addClass("animate");_$tweet_carousel_container.addClass("animate left");var callback=setTimeout(function(){_$tweet_section.removeClass("animate");_$tweet_carousel.find("li").each(function(){var $el=$(this);var current_position=parseInt($el.attr("data-position"),10);var new_position=(current_position+1)%_NUMBER_OF_TWEETS;$el.attr("data-position",new_position)});_$tweet_carousel_container.removeClass("animate left")},500)}function _moveTweetAnimationRight(){_$tweet_section.addClass("animate");_$tweet_carousel_container.addClass("animate right");var callback=setTimeout(function(){_$tweet_section.removeClass("animate");_$tweet_carousel.find("li").each(function(){var $el=$(this);var current_position=parseInt($el.attr("data-position"),10);var new_position=((current_position-1)%_NUMBER_OF_TWEETS+_NUMBER_OF_TWEETS)%_NUMBER_OF_TWEETS;$el.attr("data-position",new_position)});_$tweet_carousel_container.removeClass("animate right")},500)}function _startTweetAutoAdvance(){if(!_tweet_advance_interval){_tweet_advance_interval=setInterval(_moveTweetAnimationRight,_TWEET_ADVANCE_PERIOD_MS)}}function _stopTweetAutoAdvance(){clearInterval(_tweet_advance_interval);_tweet_advance_interval=false}function _moveHeaderCarouselRight(){if(!_header_carousel_active)return;var current=_$screenshots.attr("data-highlight");switch(current){case"channels":_$screenshots.attr("data-highlight","integrations");break;case"integrations":_$screenshots.attr("data-highlight","search");break;case"search":_$screenshots.attr("data-highlight","channels");break}}function _moveHeaderCarouselLeft(){if(!_header_carousel_active)return;var current=_$screenshots.attr("data-highlight");switch(current){case"channels":_$screenshots.attr("data-highlight","search");break;case"integrations":_$screenshots.attr("data-highlight","channels");break;case"search":_$screenshots.attr("data-highlight","integrations");break}}function _startHeaderAutoAdvance(){if(!_header_advance_interval){_header_advance_interval=setInterval(_moveHeaderCarouselRight,_HEADER_ADVANCE_PERIOD_MS)}}function _stopHeaderAutoAdvance(){clearInterval(_header_advance_interval);_header_advance_interval=false}function _moveWaysForward(){if(!_header_carousel_active)return;var current=_$ways_container.attr("data-highlight");switch(current){case"channel":_$ways_container.attr("data-highlight","dm");break;case"dm":_$ways_container.attr("data-highlight","group");break;case"group":_$ways_container.attr("data-highlight","channel");break}}function _moveWaysBack(){if(!_header_carousel_active)return;var current=_$ways_container.attr("data-highlight");switch(current){case"channel":_$ways_container.attr("data-highlight","group");break;case"dm":_$ways_container.attr("data-highlight","channel");break;case"group":_$ways_container.attr("data-highlight","dm");break}}function _startWaysAutoAdvance(){if(!_ways_advance_interval){_ways_advance_interval=setInterval(_moveWaysForward,_WAYS_ADVANCE_PERIOD_MS)}}function _stopWaysAutoAdvance(){clearInterval(_ways_advance_interval);_ways_advance_interval=false}function _getQueryVariable(variable){var query=window.location.search.substring(1);var vars=query.split("&");for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable){return pair[1]}}return false}var player,loaded=false;loadAPI=function(){var tag=document.createElement("script");tag.src="https://www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);window.onYouTubeIframeAPIReady=function(){player=new YT.Player("video_embed",{videoId:"B6zVzWU95Sw",width:"1000",height:"563",events:{onReady:window.onPlayerReady,onStateChange:window.onPlayerStateChange}})};window.onPlayerReady=function(event){openVideo()};window.onPlayerStateChange=function(event){if(event.data==0){closeVideo();setTimeout(function(){if(typeof player.seekTo!="undefined"){player.seekTo(0);player.stopVideo()}},0)}}};openVideo=function(){if(!loaded){loaded=true;loadAPI();return}$("body").addClass("video");$(window.document).bind("keydown.esc",function(e){if(e.which==27){closeVideo()}});if(typeof player.playVideo!="undefined"){player.playVideo()}};closeVideo=function(){if(typeof player.stopVideo!="undefined"){player.stopVideo()}$("body").removeClass("video");$(window.document).unbind("keydown.esc")};$("#video .thumb").on("click",function(e){e.preventDefault();openVideo()});$("#video_overlay").on("click",function(e){if(e.target&&e.target.id&&e.target.id=="video_overlay"){closeVideo()}});$("#video_close_btn").on("click",closeVideo);var landing={underline:{},has_complete_typewrite:false,init:function(){if(_getQueryVariable("story")||landing.story_name){landing.preloadImage();if($(window).width()<641){$(".typed_remove").addClass("hidden");landing.completeTypewrite()}}landing.createRotationList();landing.resetCookie()},preloadImage:function(){var story_query=_getQueryVariable("story")||landing.story_name;var header_img;if(story_query=="marsandbeyond"){header_img="nasa-header-image"}else if(story_query=="neutrinoinahaystack"){header_img="neutrino-observatory-header-image"}else if(story_query=="decodingdna"){header_img="macarthur-lab-header-image"}else if(story_query=="brewbetter"){header_img="blue-bottle-header"}else if(story_query=="openforbusiness"){header_img="square-header-image"}else{landing.startAnimation();return}var image=new Image;image.onload=function(){setTimeout(landing.startAnimation,2400)};image.src="/img/wired/"+header_img+"@tiny.jpg"},startAnimation:function(){landing.typewrite(27)},typewrite:function(speed){$(".typed_remove").addClass("hidden");$(".typewriter").typed({strings:[$(".typewriter_copy").html()],typeSpeed:speed,callback:landing.completeTypewrite})},completeTypewrite:function(){if(landing.has_complete_typewrite)return;landing.underline.robots_path=bowser.msie?$(".underline_robots_image"):$(".underline_robots_path");landing.underline.mars_path=bowser.msie?$(".underline_mars_image"):$(".underline_mars_path");landing.underline.robots=$(".underline_robots");landing.underline.mars=$(".underline_mars");var $cta_ad_header_second=$(".cta_ad_header_second");landing.underline.robots.append(landing.underline.robots_path);landing.underline.mars.append(landing.underline.mars_path);$(".typed-cursor").addClass("hide");$body.addClass("start_animation");landing.has_complete_typewrite=true},resetCookie:function(){eraseCookie("slack_landing_b1",".slack.com");eraseCookie("slack_landing_b2",".slack.com");eraseCookie("slack_landing_b3",".slack.com");eraseCookie("slack_landing_control_b",".slack.com");eraseCookie("slack_landing_b_control",".slack.com");eraseCookie("slack_ad_header_b",".slack.com");eraseCookie("slack_ad_header",".slack.com");eraseCookie("landing_page_new",".slack.com")},createRotationList:function(){var list=["neutrinoinahaystack","waterislife","marsandbeyond"];if(readCookie("lp_l")){list=readCookie("lp_l");list=list.split(",");list.push(list.shift())}createCookie("lp_l",list,365,"slack.com")}};
