// This file was automatically generated from apps.soy.
// Please don't edit this file by hand.

goog.provide('jive.apps.base.renderAppDataUploadPopup');
goog.provide('jive.apps.base.renderAppIcon');
goog.provide('jive.apps.base.renderAppProfileTooltip');

goog.require('soy');
goog.require('soydata');
goog.require('soy.StringBuilder');


jive.apps.base.renderAppDataUploadPopup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<header><h2 class="jive-modal-title">', soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg('appframework.app.upload.title'),[])), ': ', soy.$$escapeHtml(opt_data.options.dialogTitle), '</h2></header><label class="j-508-label" id="close-modal-508">', soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg('global.close.modal'),[])), '</label><a href="#" class="j-modal-close-top close" aria-labelledby="close-modal-508" title="', soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg('global.close.modal'),[])), '">', soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg('global.close'),[])), '  <span class="j-close-icon j-ui-elem" role="img"></span></a><div class="jive-modal-content j-pop-main"><div class="modal-block">', (opt_data.options.instructionMsg) ? '<p>' + soy.$$escapeHtml(opt_data.options.instructionMsg) + '</p>' : '', '<form action=', soy.$$escapeHtml(opt_data.options.actionUrl), ' class="jive-modal-file-upload" target="jive-modal-file-upload-iframe" enctype="multipart/form-data" method="post"><input type="hidden" name="request" value="" /><input type="hidden" name="jive.token.name" value="cxrf-token" /><input type="hidden" name="cxrf-token" value="" />', (opt_data.options.binaryDocument == true) ? '<p><label for="subject">Subject</label><input type="text" name="subject" id="subject" value="" /></p>' : '', '<div class="jive-error-box clearfix" style="display:none" aria-live="polite" aria-atomic="true"><div><span class="jive-icon-med jive-icon-redalert"></span><span class="message"></span></div></div><p><label for="file">File:</label><br /><input type="file" name="file" /></p>', (opt_data.options.showTitle) ? '<p><label for="title">' + ((opt_data.options.showTitle == true) ? 'Title' : soy.$$escapeHtml(opt_data.options.showTitle)) + ':</label><br /><input type="text" name="title" id="title"/></p>' : '', (opt_data.options.showDescription) ? '<p><label for="description">' + ((opt_data.options.showDescription == true) ? 'Description' : soy.$$escapeHtml(opt_data.options.showTitle)) + ':</label><br /><textarea name="description"></textarea></p>' : '', '<p><input type="submit" value="', soy.$$escapeHtml(opt_data.options.submitText), '" /></p><iframe name="jive-modal-file-upload-iframe" id="jive-modal-file-upload-iframe" style="display:none" src="about:blank"></iframe></form></div></div>');
  return opt_sb ? '' : output.toString();
};


jive.apps.base.renderAppProfileTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="jive-app-profile-toolip" style="position:absolute;top:', soy.$$escapeHtml(opt_data.top), 'px;left:', soy.$$escapeHtml(opt_data.left), 'px;" class="jive-tooltip2"><div class="jive-tooltip2-mid j-mini-modal"><div class="jive-tooltip2-mid-padding j-modal-content clearfix" id="jive-app-profile-toolip-body"></div></div></div>');
  return opt_sb ? '' : output.toString();
};


jive.apps.base.renderAppIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  switch (opt_data.type) {
    case 'small':
      output.append('<img class="j-app-fav-icon" src="', soy.$$escapeHtml(opt_data.app.favIconSrc ? opt_data.app.favIconSrc : jive.soy.func.buildUrl('images/jaf/j-icon-jaf-16.png')), ' "/>');
      break;
    case 'medium':
      output.append('<img class="j-app-icon" src="', soy.$$escapeHtml(opt_data.app.iconSrc ? opt_data.app.iconSrc : jive.soy.func.buildUrl('images/jaf/j-icon-jaf-48.png')), '"/>');
      break;
    case 'large':
      output.append('<img class="j-app-icon" src="', soy.$$escapeHtml(opt_data.app.largeIconSrc ? opt_data.app.largeIconSrc : jive.soy.func.buildUrl('images/jaf/j-icon-jaf-128.png')), '"/>');
      break;
    default:
      output.append('<img class="j-app-icon" src="', soy.$$escapeHtml(opt_data.app.iconSrc ? opt_data.app.iconSrc : jive.soy.func.buildUrl('images/jaf/j-icon-jaf-48.png')), '"/>');
  }
  return opt_sb ? '' : output.toString();
};

;
define("jive/app/app-file-uploader",["jquery","jquery/jquery.oo"],function(a,b){return b.extend({init:function(f,e,c,d,g){this.app=f;this.key=e;this.callback=g;this.element=null;this.token=d;this.options=a.extend({showTitle:false,showDescription:false,dialogTitle:this.app.title,submitText:"Upload",core:false,validExtensions:[]},c||{});this.showDialog()},showDialog:function(){var g=this;a("body").append('<div class="jive-modal" id="app-upload-modal-content" style="display:none;"></div>');this.element=a("#app-upload-modal-content");var d=this.options||{};if(typeof d.actionUrl==="undefined"){var c="";if(this.token){c=encodeURIComponent(this.token)}d.actionUrl=d.actionUrl||"/social/rpc?responseFormat=html"+(c?"&st="+c:"")}var e=a(jive.apps.base.renderAppDataUploadPopup({options:d}));var f=this.element.html(e).lightbox_me({closeSelector:".close",destroyOnClose:true}).find("iframe").bind("load",function(){g.handleIframeLoad()}).end().find("input[type=submit]").click(function(){if(g.isValid()){jive.util.securedForm(f).then(function(){f.submit()})}return false}).end().find("form")},isValid:function(){if(this.isFileBlank()){this.showError("File is required!");return false}else{if(this.isFileExtensionInvalid()){this.showError("File is invalid. Valid extensions: "+this.options.validExtensions.join(", "));return false}}return true},isFileBlank:function(){return this.element.find("input[type=file]").val()===""},isFileExtensionInvalid:function(){return this.options.validExtensions.length>0&&a.inArray(a(this.element.find("input[type=file]").val().split(".")).last()[0],this.options.validExtensions)==-1},showError:function(c){this.element.find("div.jive-error-box").show().find("span.message").html(c)},hideError:function(){this.element.find("div.jive-error-box").hide()},setRequestParams:function(){this.element.find("input[name=request]").val(JSON.stringify(this.generateRequestParams()));if(!document.cookie.match("X-JCAPI-Token")){var e=this.element.find("form").attr("action");var d;if(e){var c=e.match(/^https?:\/\/.+?(\/[0-9a-zA-Z\/]+)/);if(c&&c.length>1){d=c[1]}else{if(e.match(/^\//)){d=e}}}if(d){document.cookie="X-JCAPI-Token=MFVrG3oK; path="+d}}},generateRequestParams:function(){var e=[{method:"appdata.uploadContent",params:{appId:"@app",userId:["@viewer"],groupId:"@self",fields:[this.key],data:{}},id:"key"}];var d={url:"@field:file"};if(this.options.showTitle){var f=a("#app-upload-modal-content input[name=title]").val();if(f.length>0){d.title=f}}if(this.options.showDescription){var c=a("#app-upload-modal-content textarea[name=description]").val();if(c.length>0){d.description=c}}e[0]["params"]["data"][this.key]=d;return e},handleIframeLoad:function(){var g="jive-modal-file-upload-iframe";var e=document.getElementById(g);var i;var c=null;try{if(e.contentDocument){i=e.contentDocument}else{if(e.contentWindow){i=e.contentWindow.document}else{i=window.frames[g].document}}}catch(f){c=f}var d={};if(c!==null){var h='{"code":"4005","message":"Access denied to object"}';d=JSON.parse(h)}else{if(i.location.href=="about:blank"){return}else{d={}}}var j;if(this.options.core===true){j=d;this.callback(j);a("#app-upload-modal-content").trigger("close")}else{if(a.isArray(d)&&d[0]["result"]&&d[0]["result"]){var k=this.getValue(d[0]["result"]);if(k&&k[this.key]){j=k[this.key];this.callback(JSON.parse(j));a("#app-upload-modal-content").trigger("close")}}}},getValue:function(d){var c=null;a.each(d,function(e,f){c=f});return c}})});
;
define("jive/app/oauth/views/oauthoverlay",["apps/shared/views/abstract_view"],function(a){return a.extend(function(b){this.init=function(g,e,f){this.content=e;var d=this;e.find(".j-oauth-authorize").append("<input type='hidden' id='_alias' value='"+f+"'/>");var h=this.content.find(".j-error-msg-grant-oauth-access-btn");h.bind("click",g.get_oauth_popup().createOpenerOnClick());var c=this.content.find(".j-error-msg-granted-oauth-access-btn");c.bind("click",g.get_oauth_popup().createApprovedOnClick());var i=this.content.find(".j-error-msg-oauth-approved-btn");i.click(function(){d.emit("oauth.approved")})};this.hideGrant=function(){this.content.find(".j-oauth-grant").hide()};this.showWaiting=function(){this.content.find(".j-oauth-authorize").show()};this.hideWaiting=function(){this.content.find(".j-oauth-authorize").hide()}})});
;
jive.namespace("JAF.Configuration");jive.JAF.Configuration.PopupDialog=function(a,d,b,c){this.destination_=a;this.windowOptions_=d;this.openCallback_=b;this.closeCallback_=c;this.win_=null};jive.JAF.Configuration.PopupDialog.prototype.createOpenerOnClick=function(){var a=this;return function(){a.onClick_()}};jive.JAF.Configuration.PopupDialog.prototype.onClick_=function(){this.win_=window.open(this.destination_,"_blank",this.windowOptions_);if(this.win_){var a=this;var b=function(){a.checkClosed_()};this.timer_=window.setInterval(b,100);this.openCallback_()}return false};jive.JAF.Configuration.PopupDialog.prototype.checkClosed_=function(){if((!this.win_)||this.win_.closed){this.win_=null;this.handleApproval_()}};jive.JAF.Configuration.PopupDialog.prototype.handleApproval_=function(){if(this.timer_){window.clearInterval(this.timer_);this.timer_=null}if(this.win_){this.win_.close();this.win_=null}this.closeCallback_();return false};jive.JAF.Configuration.PopupDialog.prototype.createApprovedOnClick=function(){var a=this;return function(){a.handleApproval_()}};
;
define("jive/app/oauth/views/oauthpopup",["apps/shared/views/abstract_view"],function(a){return a.extend(function(b){this.init=function(d,e){var c=this;this.popupURI=d;this.windowChars=e;this.oauthPopup=new jive.JAF.Configuration.PopupDialog(d,e,function(){c.emit("popup.opened")},function(){c.emit("popup.closed")})};this.get_oauth_popup=function(){return this.oauthPopup};this.click=function(){this.oauthPopup.click()};b.gup=function(e,d){d=d.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+d+"=([^&#]*)";var g=new RegExp(c);var f=g.exec(e);if(f==null){return""}else{return f[1]}}})});
;
define("jive/app/oauth/main",["lib/jiverscripts/src/oo/class","lib/jiverscripts/src/conc/observable","jive/app/oauth/views/oauthoverlay","jive/app/oauth/views/oauthpopup"],function(c,d,b,a){return c.extend(function(e){d(this);this.init=function(i,g,f,h,j){this.app=i;this.alias=g;this.redirectURI=f;this.windowchars=h;this.callback=j};this.getApp=function(){return this.app};this.invokeCallback=function(){if(this.callback){this.callback()}};e.create_popup=function(){var f=this;var g=new a(this.redirectURI,this.windowChars);var i=this.callback;var h=this.app;g.addListener("popup.opened",function(){f.container.hideGrant();f.container.showWaiting();f.emit("popup.opened",h)});g.addListener("popup.closed",function(){f.container.hideWaiting();var j={authorized:true};i(j);f.emit("popup.closed",h)});return g};this.launch_popup=function(f){this.popupWrapper=this.create_popup();this.container=new b(this.popupWrapper,f,this.alias);var g=this.app;this.container.addListener("oauth.approved",function(){var j=f.find("#_error");var l=f.find("#_errorDescription");var i=!(j.length>0||l.length>0);var k=f.find("#_alias").attr("value");var h={alias:k};if(!i){h.error={code:j.attr("value"),message:l.attr("value")}}callback(h);self.emit("oauth.approved",g)})};this.authorization_done=function(h,i){var g=$j("#j-app-view-"+this.app.id);var f=g.find(".j-oauth-authorize");if(h){f.append("<input type='hidden' id='_error' value='"+h+"'/>")}if(i){f.append("<input type='hidden' id='_errorDescription' value='"+i+"'/>")}g.find(".j-error-msg-oauth-approved-btn").click()}})});
;
define("jive/app/configure/views/msgposter",["jquery"],function(a){return jive.oo.Class.extend(function(b){this.post_message=function(c,d){var e=jive.apps.configure.renderAppDataErrorMessage({messageKeys:[c]});a("<p/>").html(e).message({style:d})}})});
;
define("jive/app/credentials/views/credentials_form",["jquery","jive/app/configure/views/msgposter","jive/app/configure/views/validate","jive/app/configure/views/error"],function(c,a,d,b){return jive.AbstractView.extend(function(e){jive.conc.observable(this);e.init=function(g){var f=this;this.content=g.domTarget;this.approved=[];this.denied=[];this.currentService=1;this.configuredServices=[];this.totalServices=0;this.msg_poster=new a()};this.render=function(g){var f=this;var h=c(jive.apps.configure.renderConfigureCredentialBlocks({credentialsSetupView:g}));this.content.append(h.html());this.servicesCount=g.serviceOptionView.length;if(this.servicesCount<2){this.content.find("#current-service-counter").remove()}else{this.content.find("#current-service").text(this.currentService)}this.processServices(this.content.find(".j-service-block-container:first"))};this.activate=function(){this.content.find(".j-service-focus-hint").first().focus()};e.save=function(){var g=this.content.find(".j-service-block-container:first");var f=g.find(".j-service-block:first");var h=f.attr("data-connectionid");if(this.validate_block(f)){this.approved.push(Number(h));this.process_block(f);this.currentService++;this.content.find("#current-service").text(this.currentService);if(this.currentService<=this.servicesCount){g.hide().next().show()}else{this.postConfigurations()}}};e.process_block=function(g){var h=this;var f={serviceID:g.attr("data-serviceid"),alias:g.attr("data-alias")};f.credentials=h.get_credentials(g);this.configuredServices.push(f)};e.get_credentials=function(g){var f=[];g.find(".j-service-credential").each(function(){f.push({name:this.getAttribute("data-name"),value:this.value})});return f};e.cancel=function(){var g=this.content.find(".j-service-block-container:first");var f=g.find(".j-service-block:first");var h=f.attr("data-connectionid");this.denied.push(Number(h));this.currentService++;this.content.find("#current-service").text(this.currentService);if(this.currentService<=this.servicesCount){g.hide().next().show()}else{this.postConfigurations()}};this.completed=function(){return this.currentService>this.servicesCount};e.processServices=function(g){var j=true;var f=g;var h=this;var i;while(f.length){var k=f.find(".app-config-save");f.find(".app-config-save").click(function(){h.save()});f.find(".app-config-cancel").click(function(){h.cancel()});f.find(".j-service-credential").keypress(function(m){var l=m.which||m.keyCode;if(l===jive.Event.KEY_RETURN){k.click()}});if(j&&f.css("display")!="none"){i=f.find(".j-service-focus-hint");if(i.length){j=false}}f=f.next()}};e.validate_block=function(g){var i=new b();i.clear();var f={};var h=[];g.find(".j-service-error").removeClass("j-service-error");var j=new d(g,f,h);j.work();if(h.length){i.render(f);i.fieldsToVisualMarkers(h)}return h.length==0};e.postConfigurations=function(){if(!this.denied||this.denied.length<1){this.emit("app.credentials_done",{services:this.configuredServices,approved:this.approved,denied:this.denied})}else{this.emit("app.credentials_cancelled")}};this.msgSuccess=function(f){this.msg_poster.post_message("credentials.success","success")};this.msgFailed=function(f){this.msg_poster.post_message("credentials.fail","success")};this.msgCancelled=function(f){this.msg_poster.post_message("credentials.cancel","warn")}})});
;
define("jive/app/credentials/models/credentials_model",["jquery"],function(a){return jive.oo.Class.extend(function(b){jive.conc.observable(this);b.init=function(d){var c=this;this.alias=d.alias};this.get_credentials=function(e,c){var f=new jive.conc.Promise();var d=jive.api.apps("instances/"+e+"/credentials_setup?aliases="+c);a.ajax({url:d,type:"GET",success:function(g){f.emitSuccess(g)}});return f};this.persist=function(f,e){var d=this;var c={instanceAppID:f,services:e.services};a.ajax({type:"PUT",url:jive.api.apps("instances/update_credentials"),data:JSON.stringify(c),contentType:"application/json",dataType:"json",success:function(h){var g={alias:d.alias};d.emit("app.credentials.persisted.success",g)},error:function(i){var g={alias:d.alias,error:{}};g.error.code=i.status?i.status:500;g.error.message=i.statusText;if(i.response&&i.response.startsWith("{")){var h=JSON.parse(i.response);if(h.message){g.error.message=h.message}}d.emit("app.credentials.persisted.failed",g)}})}})});
;
define("jive/app/credentials/main",["jive/app/credentials/views/credentials_form","jive/app/credentials/models/credentials_model"],function(a,b){return jive.oo.Class.extend(function(c){jive.conc.observable(this);c.init=function(e){var d=this;var h=e.instanceAppID;var f=e.serviceAlias;d.completionCallback=e.completionCallback;this.model=new b({alias:e.serviceAlias});var g=e.domTarget;this.view=new a({domTarget:g});this.view.addListener("app.credentials_done",function(i){d.model.persist(h,i)});this.view.addListener("app.credentials_cancelled",function(){d.emitFailure("The user denied this operation.")});this.model.get_credentials(h,f).addCallback(function(i){d.view.render(i)});this.model.addListener("app.credentials.persisted.success",function(i){d.view.msgSuccess(i);d.completionCallback(i)});this.model.addListener("app.credentials.persisted.failed",function(i){d.view.msgFailed(i);d.completionCallback(i)})};this.emitFailure=function(f){var e=this;var d={alias:e.serviceAlias};d.error={code:401,message:f};e.view.msgCancelled(d);e.completionCallback(d)};this.activate=function(){this.view.activate()};this.completed=function(){return this.view.completed()}})});
;
define("jive/app/core_container/views/credentials_view",["jquery","jive/app/credentials/main"],function(a,b){return jive.oo.Class.extend(function(c){jive.conc.observable(this);this.init=function(d){this.app=d.app;this.serviceAlias=d.args.alias;this.callback=d.callback;this.completed=false};this.getApp=function(){return this.app};this.createUI=function(){var d=this;this.ui=a(jive.apps.container.credentialsView());this.credentialsMain=new b({domTarget:d.ui,instanceAppID:d.app.instanceAppID,serviceAlias:d.serviceAlias,completionCallback:function(e){d.callback(e);if(e.error){d.emit("app.credentials.complete.error")}else{d.emit("app.credentials.complete.success")}}});return this.ui};this.activate=function(){if(!this.credentialsMain){return}var d=this;window.setTimeout(function(){d.credentialsMain.activate()},350)};this.cleanup=function(){if(!this.credentialsMain.completed()){this.credentialsMain.emitFailure("The user cancelled this operation");this.emit("app.service.message",{severity:"warn",message:"You may not be able to use this app until you provide credentials."})}}})});
;
// This file was automatically generated from apps-preferences.soy.
// Please don't edit this file by hand.

goog.provide('jive.apps.preferences.prefBool');
goog.provide('jive.apps.preferences.prefSelect');
goog.provide('jive.apps.preferences.renderAppDataErrorMessage');
goog.provide('jive.apps.preferences.renderNoPreferences');
goog.provide('jive.apps.preferences.renderPreferences');
goog.provide('jive.apps.preferences.renderPrefs');

goog.require('soy');
goog.require('soydata');
goog.require('soy.StringBuilder');


jive.apps.preferences.renderAppDataErrorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var messageKeyList3 = opt_data.messageKeys;
  var messageKeyListLen3 = messageKeyList3.length;
  for (var messageKeyIndex3 = 0; messageKeyIndex3 < messageKeyListLen3; messageKeyIndex3++) {
    var messageKeyData3 = messageKeyList3[messageKeyIndex3];
    output.append('<span class="error-message">');
    switch (messageKeyData3) {
      case 'preferences.success':
        output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg('appframework.app.options.preferences.success'),[])));
        break;
      default:
        output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg('error.general'),[])));
    }
    output.append('</span>');
  }
  return opt_sb ? '' : output.toString();
};


jive.apps.preferences.renderPreferences = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<section><form action="#" id="jivewidgetpropform-', soy.$$escapeHtml(opt_data.instanceAppID), '" class="j-form"><input type="hidden" name="appId" value="', soy.$$escapeHtml(opt_data.instanceAppID), '"/>');
  var prefList18 = opt_data.appPreferences;
  var prefListLen18 = prefList18.length;
  for (var prefIndex18 = 0; prefIndex18 < prefListLen18; prefIndex18++) {
    var prefData18 = prefList18[prefIndex18];
    output.append('<p><label for="app-pref-', soy.$$escapeHtml(opt_data.instanceAppID), '-', soy.$$escapeHtml(prefData18.identifier), '">', soy.$$escapeHtml(prefData18.name), '</label>');
    switch (prefData18.dataType) {
      case 'enum':
        jive.apps.preferences.prefSelect({pref: prefData18, instanceAppID: opt_data.instanceAppID}, output);
        break;
      case 'bool':
        jive.apps.preferences.prefBool({pref: prefData18, instanceAppID: opt_data.instanceAppID}, output);
        break;
      default:
        output.append('<input type="text" size="40" class="jive-widget-edit-elem-url" id="app-pref-', soy.$$escapeHtml(opt_data.instanceAppID), '-', soy.$$escapeHtml(prefData18.identifier), '" name="', soy.$$escapeHtml(prefData18.identifier), '" value="', soy.$$escapeHtml(prefData18.value), '" />');
    }
    output.append('</p>');
  }
  output.append('</form></section>');
  return opt_sb ? '' : output.toString();
};


jive.apps.preferences.renderNoPreferences = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<section><p>', soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg('appframework.app.preferences.none'),[])), '</p></section>');
  return opt_sb ? '' : output.toString();
};


jive.apps.preferences.renderPrefs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" id="jivewidgetpropform-', soy.$$escapeHtml(opt_data.instanceAppID), '" class="j-form"><input type="hidden" name="appId" value="', soy.$$escapeHtml(opt_data.instanceAppID), '"/>');
  var prefList58 = opt_data.prefs;
  var prefListLen58 = prefList58.length;
  for (var prefIndex58 = 0; prefIndex58 < prefListLen58; prefIndex58++) {
    var prefData58 = prefList58[prefIndex58];
    output.append('<p><label for="app-pref-', soy.$$escapeHtml(opt_data.instanceAppID), '-', soy.$$escapeHtml(prefData58.identifier), '">', soy.$$escapeHtml(prefData58.name), '</label>');
    switch (prefData58.dataType) {
      case 'enum':
        jive.apps.preferences.prefSelect({pref: prefData58, instanceAppID: opt_data.instanceAppID}, output);
        break;
      case 'bool':
        jive.apps.preferences.prefBool({pref: prefData58, instanceAppID: opt_data.instanceAppID}, output);
        break;
      default:
        output.append('<input type="text" size="40" class="jive-widget-edit-elem-url" id="app-pref-', soy.$$escapeHtml(opt_data.instanceAppID), '-', soy.$$escapeHtml(prefData58.identifier), '" name="', soy.$$escapeHtml(prefData58.identifier), '" value="', soy.$$escapeHtml(prefData58.value), '" />');
    }
    output.append('</p>');
  }
  output.append('<p><button type="button" id="app-pref-save">', soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg('global.save_settings'),[])), '</button></p></form>');
  return opt_sb ? '' : output.toString();
};


jive.apps.preferences.prefSelect = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select class="jive-widget-edit-elem-url" id="app-pref-', soy.$$escapeHtml(opt_data.instanceAppID), '-', soy.$$escapeHtml(opt_data.pref.identifier), '" name="', soy.$$escapeHtml(opt_data.pref.identifier), '">');
  var valueList98 = opt_data.pref.values;
  var valueListLen98 = valueList98.length;
  for (var valueIndex98 = 0; valueIndex98 < valueListLen98; valueIndex98++) {
    var valueData98 = valueList98[valueIndex98];
    output.append('<option value="', soy.$$escapeHtml(valueData98.identifier), '" ', (valueData98.selected) ? 'selected="selected"' : '', '>', soy.$$escapeHtml(valueData98.name), '</option>');
  }
  output.append('</select>');
  return opt_sb ? '' : output.toString();
};


jive.apps.preferences.prefBool = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="checkbox" class="jive-widget-edit-elem-url" id="app-pref-', soy.$$escapeHtml(opt_data.instanceAppID), '-', soy.$$escapeHtml(opt_data.pref.identifier), '" name="', soy.$$escapeHtml(opt_data.pref.identifier), '" value="true" ', (opt_data.pref.value) ? 'checked=\'checked\'' : '', '/>');
  return opt_sb ? '' : output.toString();
};

;
define("jive/app/preferences/views/preferences_view_default",["jquery"],function(a){return jive.oo.Class.extend(function(b){jive.conc.observable(this);b.init=function(c){this.domTarget=c};this.create_message=function(c,d){var e=jive.apps.preferences.renderAppDataErrorMessage({messageKeys:[c]});return{message:e,style:d}};this.edit_app_preferences=function(h,f){var d=this;var e=h.instanceAppID;if(!f.preferences||f.preferences.length<1){d.emit("app.service.wire.nav.hide");this.domTarget.html("");this.domTarget.append(a(jive.apps.preferences.renderNoPreferences()))}else{var g=a(jive.apps.preferences.renderPreferences({instanceAppID:e,appPreferences:f.preferences.length?f.preferences:[f.preferences]}));var c=function(){var i=g.find(".jive-widget-edit-elem-url");if(i.length){a(i.get(0)).focus()}};d.emit("app.service.wire.submit",{callback:function(){d.emit("app.preferences.save",g.find("form"))}});this.domTarget.html("");this.domTarget.append(g)}}})});
;
define("jive/app/preferences/models/preferences_model",["jquery"],function(a){return jive.oo.Class.extend(function(b){jive.conc.observable(this);b.init=function(){this.GADGET_ENDPOINT=jive.rest.url("/app");this.options=function(f,d,e,c){if(e){d=d+"?"+a.param(e)}return{type:f,url:this.GADGET_ENDPOINT+d,dataType:"json",contentType:"application/json; charset=utf-8",success:c}}};this.setPref=function(g,c,e){var d=this;var f={n:c,v:e};a.ajax(this.options("PUT","/"+g+"/prefs",f,function(h){d.emit("app.preferences.set",h)}))};this.getPreferences=function(d){var c=this;a.ajax(this.options("GET","/"+d+"/prefs/",null,function(e){c.emit("app.preferences.get",e.pref)}))};this.setPreferences=function(d){var c=this;d.ajaxSubmit({url:this.GADGET_ENDPOINT+"/setprefs/",type:"POST",dataType:"json",success:function(e){c.emit("app.preferences.set.all",e.dashboardAppSrc)}})};this.cancelEdit=function(d){var c=this;a.ajax(this.options("GET","/"+d,null,function(e){c.emit("app.preferences.cancel.edit",e)}))};this.getPreferencesView=function(d){var c=this;a.ajax(this.options("GET","/"+d+"/prefs/view",null,function(e){c.emit("app.preferences.get.pref.view",e.appPrefView)}))}})});
;
define("jive/app/preferences/main",["jive/app/preferences/models/preferences_model","jive/app/preferences/views/preferences_view_default"],function(b,a){return jive.oo.Class.extend(function(c){jive.conc.observable(this);c.init=function(f,d){this.source=new b();var e=this;this.defaultView=new a(d);this.defaultView.addListener("app.service.wire.submit",function(g){e.emit("app.service.wire.submit",g)});this.defaultView.addListener("app.service.wire.cancel",function(g){e.emit("app.service.wire.cancel",g)});this.defaultView.addListener("app.service.wire.none");this.source.addListener("app.preferences.get.pref.view",function(g){if(g.customView){e.emit("app.service.wire.none");e.emit("app.preferences.get.custom.view",g.viewUrl)}else{e.defaultView.addListener("app.preferences.save",function(h){e.source.setPreferences(h)});e.defaultView.edit_app_preferences(f,g)}});this.source.addListener("app.preferences.set.all",function(){e.emit("app.preferences.default.saved",{message:"Your preferences have been saved."})});this.source.getPreferencesView(f.instanceAppID)}})});
;
define("jive/app/core_container/views/services_view",["jquery","jive/app/core_container/views/appscontainer_view","jive/app/configure/main","jive/app/preferences/main"],function(d,a,b,c){return a.extend(function(e,f){jive.conc.observable(this);var h;var g;this.init=function(k,i,j){f.init.call(this,i,j);this.app=k;this.commonContainer=i;this.options=j;this.serviceSites=[]};this.setMarketApp=function(i){this.marketApp=i};this.isActive=function(){return d("#app-services-container").length?true:false};this.createUI=function(){return d(jive.apps.container.servicesView({app:this.app}))};this.activate=function(){this.determineLeftNavItems(this.app);this.registerLeftNavHandlers();d(".j-modal-nav li a").click(function(i){d(this).parent("li").addClass("selected").siblings("li").removeClass("selected")});this.hideNav();d("#j-app-svcs-about").click()};e.determineLeftNavItems=function(i){d("#j-app-svcs-settings").parent().show();if(!i.userPrefsAvailable){d("#j-app-svcs-settings").hide()}if(!i.configurationAvailable||i.configurationError){d("#j-app-svcs-config").hide()}};e.hideNav=function(){d("#app-services-container .j-modal-footer").hide()};e.showNav=function(){d("#app-services-container .j-modal-footer").show()};e.wireButtonListeners=function(j){var i=this;j.addListener("app.service.wire.submit",function(k){i.showNav();d("#j-app-services-submit").click(k.callback)});j.addListener("app.service.wire.cancel",function(k){i.showNav();d("#j-app-services-cancel").click(k.callback)});j.addListener("app.service.wire.nav.show",function(){i.showNav()});j.addListener("app.service.wire.nav.hide",function(){i.hideNav()})};this.prepareDetail=function(){var i=d("#app-services-detail");i.html("");return i};e.registerLeftNavHandlers=function(){var i=this;if(d("#j-app-sys-settings").length==1){d("#j-app-sys-settings").click(function(m){i.hideNav();var n="sys-settings-view";var k=i.prepareDetail();i.setCurrentSettingsView(n);var l=i.prepareSiteViewIfRequired(n,k[0]);i.showSpinner(k);i.requestNavigateTo(i.app,l,"system-settings",null,function(o){l.jiveData=new JiveSiteData(i,i.app,{});l.jiveData.setGadgetMetaData(o)});i.emit("app.navigate.admin-settings");m.preventDefault()})}d("#j-app-svcs-settings").click(function(l){i.hideNav();var k={};var n="user-settings-view";var o=i.prepareDetail();i.setCurrentSettingsView(n);var m=new c(i.app,o);i.wireButtonListeners(m);m.addListener("app.preferences.get.custom.view",function(r){var p=o[0];var q=i.prepareSiteViewIfRequired(n,p);i.showSpinner(o);i.requestNavigateTo(i.app,q,"user-prefs",null,function(s){q.jiveData=new JiveSiteData(i,i.app,{});q.jiveData.setGadgetMetaData(s)})});m.addListener("app.preferences.default.saved",function(p){i.servicesClose();i.sendNotification({severity:"info",message:p.message});i.emit("app.reload")});i.emit("app.navigate.user-prefs");l.preventDefault()});d("#j-app-svcs-config").click(function(m){var k=i.prepareDetail();var n="app-service-config-view";i.setCurrentSettingsView(n);var l=new b({app:i.app,domTarget:k});i.wireButtonListeners(l);l.addListener("app.configure.success",function(){i.servicesClose();var o=jive.apps.container.renderMessage({messageKey:"appframework.app.configure.success"});i.sendNotification({severity:"info",message:o});i.emit("app.reload")});l.addListener("app.configure.failed",function(){var o=jive.apps.container.renderMessage({messageKey:"appframework.app.configure.failure"});i.sendNotification({severity:"error",message:o})});i.emit("app.navigate.configure");m.preventDefault()});d("#j-app-svcs-developer").click(function(m){i.hideNav();var n="app-developer-view";i.setCurrentSettingsView(n);var l=i.prepareDetail();var o=i.app;if(typeof(o.developerModel)=="undefined"){o.developerModel=new jive.JAF.Configuration.DeveloperModel()}var k=new jive.JAF.Configuration.Developer({app:o,domTarget:l});i.emit("app.navigate.developer");m.preventDefault()});d("#j-app-svcs-about").click(function(o){var p="app-about-view";if(i.currentView==p){return}i.hideNav();var l=i.prepareDetail();i.setCurrentSettingsView(p);var m=i.prepareSiteViewIfRequired(p,l[0]);if(i.app.aboutViewAvailable){i.requestNavigateTo(i.app,m,"about",null,function(r){m.jiveData=new JiveSiteData(i,i.app,{});m.jiveData.setGadgetMetaData(r)})}else{var q={};if(i.app.appUUID){q.market={experience:"about"};q.market.appUUID=i.app.appUUID}else{q.market={experience:"default"}}var k=i.prepareMarketContext(q);var n=i.getEmbeddedContext(k.embeddedID);n.target.view="embedded";i.renderAppEE_(l[0],i.marketApp,n,function(s,r){aboutSite=s;aboutSite.jiveData=new JiveSiteData(i,i.marketApp,{});aboutSite.jiveData.setEEContext(n);aboutSite.jiveData.setGadgetMetaData(r);var t=l.find("iframe");t.removeData();if(i.marketApp.marketFeatureAvailable){t.data("hasMarketFeature",true)}t.css({height:"500px",width:"450px"})})}i.emit("app.navigate.about");o.preventDefault()});var j=function(k){i.servicesClose();k.preventDefault()};d(".j-modal-back-top").click(j);d("#j-app-services-cancel").click(j)};e.servicesClose=function(i){this.setCurrentSettingsView(null);this.emit("app.services.close")};this.setCurrentSettingsView=function(i){if(this.currentView!=i){if(this.serviceSites[i]){this.commonContainer.closeGadget(this.serviceSites[i]);this.currentView=null;this.serviceSites[i]=null}}this.currentView=i};this.prepareSiteViewIfRequired=function(k,i){var j=this.serviceSites[k];if(j){return j}this.serviceSites[k]=this.commonContainer.newGadgetSite(i);this.currentView=k;return this.serviceSites[k]};this.requestNavigateTo=function(l,i,k,j,m){l.view=k;this.renderApp_(i,l,m,j)};e.showSpinner=function(i){var j=new jive.loader.LoaderView({size:"small",inline:true});j.appendTo(d(i));j.show()}})});
;
define("jive/app/core_container/views/canvas_view",["jquery","jive/app/core_container/views/appscontainer_view","jive/app/alert/main","jive/app/core_container/navigate_app"],function(d,a,b,c){return a.extend(function(e,g){jive.conc.observable(this);var h={CANVAS:"app.canvas.run"};var i;var f=new c();this.init=function(k,l){var j=this;g.init.call(this,k,l)};this.getActionOriginEnum=function(){return h};e.handleAppAlert=function(l){var k=this;var j=function(){var n=l.getApp();if(!n.configurationError){k.renderModal(n,function(){k.emit("app.canvas.modal.close")});k.handleConfigurationDialog(l,{modalWidth:650,modalHeight:500,configureCallback:function(o){if(o){k.closeModal()}}})}};l.applyBlock();var m=l.getActiveAlert();if(m.code==1000||m.code==1010){j()}else{k.hideChromeNav()}l.addListener("app.block",function(n){l.routeActionClicks(n,function(){j()},function(){window.location=window._jive_base_url+"/"},function(){var o=jive.apps.container.renderMessage({messageKey:"error.general"});k.sendNotification({severity:"error",message:o})},k)})};this.render=function(m,t,k,p,l){var q=d(".j-app-canvas")[0];var s=this;var n=f.addActionQueueItemToViewParams(t);var r=f.getCanvasAppInfoFromUrl();if(r!==null){var o=(n!==null)?n:{};f.setCanvasToken({appInfo:r,view:m.view,params:o})}if(k){this.renderAppEE_(q,m,k,function(v,u){i=v;v.jiveData=new JiveSiteData(s,m,n);v.jiveData.setEEContext(k);v.jiveData.setGadgetMetaData(u);var w=d(v.getActiveSiteHolder().getIframeElement());w.attr("width","100%");if(m.marketFeatureAvailable){w.data("hasMarketFeature",true)}p.call(v)})}else{i=this.commonContainer.newGadgetSite(q);var j=i;j.jiveData=new JiveSiteData(this,m);if(l){j.jiveData.launchContext=l}this.loadAppIframe(m,j,n,p)}d("#j-canvas-app-refresh-btn").unbind("click").click(function(u){s.emit("app.services.refresh",u.currentTarget);u.preventDefault()});d("#j-canvas-app-delete-btn").unbind("click").click(function(u){s.emit("app.delete",m,function(){window.location=window._jive_base_url+"/"},function(){s.displayRefreshMsg(false)});u.preventDefault()});d("#j-canvas-app-preference-btn").unbind("click").click(function(u){s.emit("app.services.show",m);u.preventDefault()})};this.getRenderedApp=function(){return i&&i.jiveData?i.jiveData.app:null};this.reload=function(){if(!i){return}var j=i.jiveData;this.commonContainer.closeGadget(i);j.app.view=j.getAppView();this.render(j.app,j.viewParams,j.getEEContext())};this.setTitle=function(k){if(!i){return}this.altTitle=k;var j=i.jiveData;d(".js-canvas-app-title").text(k||j.app.title||"")};this.requestNavigateTo=function(n,l,j,m,o){var k=this;k.loadAppIframe(n,l,m,o)};this.loadAppIframe=function(m,l,j,n){var k=this;k.renderApp_(l,m,function(q){var o;if(l.jiveData&&l.jiveData.launchContext){o=l.jiveData.launchContext}l.jiveData=new JiveSiteData(k,m,j);if(o){l.jiveData.launchContext=o}l.jiveData.setGadgetMetaData(q);var p=d(l.getActiveSiteHolder().getIframeElement());p.attr("width","100%");if(m.marketFeatureAvailable){p.data("hasMarketFeature",true)}else{if(d.browser.msie&&d.browser.version<8){p.attr("scrolling","no")}else{p.removeAttr("scrolling")}p.attr("overflow","auto")}if(n){n(q)}},j)};this.resizeContainerHeight=function(k,j,l){var m=d(l.getActiveSiteHolder().getIframeElement());if(k==="max"){k=this.getMaximumHeight()}m[j?"animate":"css"]({height:(k+"px")},{duration:300,queue:false})};this.maximizeApp=function(j){this.resizeContainerHeight("max",false,j)};this.getMaximumHeight=function(){return d(window).height()};this.getMaximumWidth=function(){return d(window).width()};this.scrollIntoView=function(p,o){var k=o||{};var m=k.bottomOffset;var j=k.verticalAlignment==null?"bottom":k.verticalAlignment;var n=d("#"+p).parents(".j-app-canvas");var l;if(j==="top"){l=-8}else{if(j==="center"||j==="middle"){l=(20+n.height()-d(window).height())/2}else{if(isFinite(j)){l=Number(j);if(l<0){if(n.offset().top){l=-n.offset().top}}}else{m=isFinite(m)?Number(m):0;l=m+n.height()-d(window).height()-d(".j-canvas-preference-container").height()-15}}}d.scrollTo(n,{duration:500,offset:{left:0,top:l}})};this.renderModal=function(n,l){var j=this;this.html=d(jive.apps.container.canvasConfigurationModal({app:n}));var m=function(s,q){var o=j.getRealTitle(s,q);var p=(d("#j-app-modal-parent").width()/8)-8;o=o.length>p?o.substring(0,p)+" ...":o;j.setModalTitle(o);var r=d(window).height()+d(document).scrollTop()-(d("#jive-canvas-modal").offset().top+d("#jive-canvas-modal").outerHeight())<0;if(r){e.recenter(k,false)}};var k=this.html.lightbox_me({closeSelector:".close",destroyOnClose:true,centered:true,modalCSS:{top:"0px"},onLoad:function(){m(n,j.altTitle)},onClose:l||function(){}})};this.invokeSettings=function(l,n){this.renderModal(n);var k=l.createUI();d("#j-app-modal-parent").append(k);var j=550;var m=600;d("#j-app-modal-parent").css({height:j,width:m});l.activate()};this.destroySettings=function(){this.closeModal()};this.invokeCredentials=function(l){var k=this;this.renderModal(l.getApp(),function(){k.emit("app.canvas.modal.close")});var j=l.createUI();d("#j-app-modal-parent").append(j);l.activate();this.resizeModal(260,600,false)};this.destroyCredentials=function(){this.closeModal()};this.resizeModal=function(j,l,k){d("#j-app-modal-parent").css({height:j,width:l})};this.invokeOauthDance=function(l){var j=this;var k=d(".j-app-canvas");d(".j-app-canvas iframe").hide();var p=l.getApp();var o=new b(p,k);var n={appTitle:p.title,code:2060,message:"",creator:"",errorMessage:"",iconSrc:p.iconSrc};var m=o.applyBlock(k,p,n);l.launch_popup(d(m));l.addListener("popup.closed",function(){d(m).remove();d(".j-app-canvas iframe").show();l.invokeCallback()})};e.closeModal=function(){if(this.html&&this.html.find&&this.html.find("a.close")){this.html.find("a.close").click()}};this.restoreChromeNav=function(){d(".j-canvas-app-chromeopts").show()};this.hideChromeNav=function(){d(".j-canvas-app-chromeopts").hide()};this.handleAppsMarketInstall=function(m){var k=f.getCanvasAppInfoFromUrl();var l=f.getCanvasToken();var j=null;if(l!==null&&l.hasOwnProperty("appInfo")&&l.appInfo==k){if(k!==null&&k===m.appUUID||k===m.appPath){m.view=l.view;j=l.params;if(typeof m.view==="undefined"||m.view===null){m.view="canvas"}if(!i){return}this.commonContainer.closeGadget(i);this.render(m,j)}}f.setCanvasToken({})}})});
;
jive.namespace("Navbar.Menu.Apps");define("apps/navbar/menu/apps/instances/views/animated_install",function(){var a=-40;jive.Navbar.Menu.Apps.InstallAnimation=jive.oo.Class.extend(function(b){var f=jQuery;var g=new jive.conc.Promise();var e="";var d={initialDelay:500,delayAfterPlacedInLauncher:250,targetSlide:750,iconSweep:2500,multiInstallDelay:333,showMarkers:false,showDouble:false};jive.conc.observable(this);this.init=function(){this._animationQueue=[];this._active=-1;this._animationRunning=false};this.getPromise=function(){return g};b.begin=function(){var h=this;h.emitP("begin").addCallback(function(j){if(j&&j.length>0){h.stripDomain(j);var i=h.showTarget(j);if(i){window.setTimeout(function(){h.animate()},d.initialDelay)}else{h._animationQueue.length=0;h.addToQueue("--last-item--");h.hideTarget()}}else{h._animationQueue.length=0;h.end(false)}}).addErrback(function(){h._animationQueue.length=0;h.end(false)})};b.stripDomain=function(j){var k=/^https?:\/\/.+?\//;if(j&&j.length){for(var h=0;h<j.length;++h){j[h].url=j[h].url.replace(k,"/");j[h].iconSrc=j[h].iconSrc.replace(k,"/");j[h].largeIconSrc=j[h].largeIconSrc.replace(k,"/");j[h].favIconSrc=j[h].favIconSrc.replace(k,"/")}}};b.showTarget=function(D){var w=this;var z=$j("<div/>").css({position:"absolute",width:"100%",top:"0",left:"0",visibility:"hidden","z-index":"9999"}).html($j("#j-header-wrap").clone());z.find("#j-header-wrap").removeAttr("id");z.appendTo($j("body"));z.delegate("*","click",function(i){i.preventDefault()});var p=z.find("#appsQuickLaunchLink").addClass("active");var s=p.outerHeight();if(this.calculateHeaderStart(z)>0){s+=p.offset().top}var v=this.calculateHeaderEnd();var C=$j("<div/>").addClass("j-pop").css({position:"absolute",top:"0",left:"0",visibility:"hidden","z-index":"9999"}).append($j("<div/>").addClass("j-quick-menu j-pop-main").attr("id","animatedAppQuickLaunchMenu").html($j(jive.nav.menu.apps.instances.content({links:D,appsMarketEnabled:window.appsMarketEnabled}))));C.append($j("<span/>").addClass("belowArrow pointer"));C.insertBefore(z);C.delegate("*","click",function(i){i.preventDefault()});e=C.find(".app-list-sm-icon").length?"app-list-sm-icon":"app-list-lg-icon";var h=$j(document).scrollTop()+s+8+3;var m=C.outerHeight();var B=h-m-s+a;var t=p.offset().left+p.outerWidth()/2;var l=C.outerWidth();var x=Math.max(t-l/2,96);C.find("> .pointer").css("left",(t-x-9)+"px");var u=window.setTimeout(function(){u=null;v=w.calculateHeaderEnd();z.css({top:w.calculateHeaderStart(z)+"px",visibility:""});z.animate({top:v+"px"},d.targetSlide,"easeInOutSine",function(){w.emit("animation.show-header.end")});h=$j(document).scrollTop()+s+8+3;B=h-m-s+a;C.css({top:B+"px",left:x+"px",visibility:""});C.animate({top:h+"px"},d.targetSlide,"easeInOutSine",function(){w.emit("animation.show-target.end")})},d.initialDelay);var k=this.hideTarget;var A=this.resolveTarget;var j=this.addToQueue;this.hideTarget=function(){w.hideTarget=k;w.resolveTarget=A;if(u){window.clearTimeout(u);u=null;z.remove();C.remove();o.remove();w.end(false);return}z.animate({top:w.calculateHeaderStart(z)+"px"},d.targetSlide,"easeInOutSine",function(){w.emit("animation.hide-header.end");z.remove();w.end(true)});C.animate({top:B+"px"},d.targetSlide,"easeInOutSine",function(){w.emit("animation.hide-target.end");C.remove()});o.remove()};this.resolveTarget=function(F){if(F.end.position&&F.end.position.resolved){return}F.end.element=C.find(F.end.selector);if(F.end.element.length){var G=F.end.element.offset();var I=F.end.element.find(".js-app-icon");F.end.size=I.innerWidth();if(F.start.size!=F.end.size){var E=F.start.element.find("img.js-app-icon");E.css("margin-top",((E.css("margin-top")||0)+(128-F.start.size)/2)+"px");var H=E.clone().attr("src",I.attr("src"));E.addClass("app-icon-1").css({width:F.start.size+"px",height:F.start.size+"px",opacity:"1","margin-left":(0-F.start.size)+"px"});H.addClass("app-icon-2").css({width:F.start.size+"px",height:F.start.size+"px",opacity:"0.001"});H.insertBefore(E);F.start.element.find(".app-icon-1").css({"margin-top":"-"+F.start.size+"px"})}if(d.showMarkers){jive.Navbar.Menu.Apps.InstallAnimation.rt(0,0).prependTo(F.end.element)}var i=w.getIconCenter(F.start.element);F.end.position={x:G.left+x,y:G.top+h,resolved:true};if(!F.start.position.resolved){F.start.position={x:F.start.position.x-i.left,y:F.start.position.y-i.top,resolved:true}}}};this.addToQueue=function(i){if(i==="--last-item--"){w.addToQueue=j;return}i.start.element.prependTo(o);this.resolveTarget(i);this._animationQueue.push(i);j.apply(this,arguments);i.start.element.css({top:i.start.position.y+"px",left:i.start.position.x+"px"})};var o=$j("<span/>").attr("id","__animation_appIconHolder").addClass("j-pop").addClass(e).css({position:"absolute",top:"0",left:"0"}).appendTo($j("body"));var n=0;for(var y=0;y<this._animationQueue.length;++y){var r=this._animationQueue[y];r.start.element.prependTo(o);this.resolveTarget(r);if(r.end.element.length){n++;r.start.element.css({top:r.start.position.y+"px",left:r.start.position.x+"px"});if(!d.showDouble){r.end.element.css({visibility:"hidden"})}}else{r.start.element.remove()}}this.emit("animation.app-icon.start");this._animationRunning=true;return n};b.hideTarget=function(){this.end(true)};b.resolveTarget=function(h){h.end.element=[]};b.addToQueue=function(h){this._animationQueue.push(h)};b.calculateHeaderEnd=function(){return f(document).scrollTop()};b.calculateHeaderStart=function(h){var j=!!f("body > .jive-modal").length,i=j?-Infinity:0;return Math.max(this.calculateHeaderEnd()-h.outerHeight+a,i)};b.animate=function(){var l;do{l=this._animationQueue.shift();if(!l){this.addToQueue("--last-item--");return}}while(!l.end.element.length);this._active++;var k=this;window.setTimeout(function(){k.animate()},d.multiInstallDelay);var h={x:$j(window).width()/2+$j(document).scrollLeft(),y:$j(window).height()/2+$j(document).scrollTop()};function i(o,n,q){return{x:o.x+n,y:o.y+q}}l.start.element.delegate("*","click",function(n){n.preventDefault()});var j=[l.start.position,h,i(l.end.position,0,150),i(l.end.position,0,-32),l.end.position];var m={css:function(r){var q=1-r;var u=j.concat();while(u.length>1){for(var p=0,o=1,n=u.length;o<n;++p,++o){u[p]={x:Math.round(u[p].x*r+u[o].x*q),y:Math.round(u[p].y*r+u[o].y*q)}}u.length--}return{left:u[0].x+"px",top:u[0].y+"px"}}};l.start.element.animate({path:m},d.iconSweep,"easeOutSine",function(){function n(){l.start.element.remove();k._active--;if(k._active==0){k.emit("animation.app-icon.end");k.hideTarget()}}if(d.showDouble){l.end.element.css({visibility:""});window.setTimeout(n,d.delayAfterPlacedInLauncher);return}l.end.element.css({visibility:"",opacity:"0.001"});l.end.element.animate({opacity:"1"},Math.round(d.delayAfterPlacedInLauncher*0.333),"easeInOutSine");l.start.element.animate({opacity:"0"},Math.round(d.delayAfterPlacedInLauncher),"easeInOutSine",n)});if(l.start.size!=l.end.size){l.start.element.find(".app-icon-1").animate({opacity:"0.001",width:l.end.size+"px",height:l.end.size+"px","margin-top":"-"+l.end.size+"px"},d.iconSweep,"easeOutCubic");l.start.element.find(".app-icon-2").animate({opacity:"1",width:l.end.size+"px",height:l.end.size+"px"},d.iconSweep,"easeOutCubic");l.start.element.find(".app-icon-2, .j-app-title").animate({opacity:"1"},d.iconSweep)}else{l.start.element.find(".j-app-title").animate({opacity:"1"},d.iconSweep)}};b.end=function(h){if(h){g.emitSuccess()}else{g.emitError()}if(this._animationQueue.length){g=new jive.conc.Promise();this.begin()}else{this.emit("destroy");this._active=false}};function c(i){var h=i?/^(0|[1-9]\d*)(.\d+)?/.exec(i):null;return h?Number(h[0]):0}b.getIconCenter=function(h){var j=h.position();var i=h.find("img.js-app-icon");var l=i.position();var k={top:l.top-j.top+c(i.css("margin-top"))+i.innerHeight()/2,left:l.left-j.left+c(i.css("margin-left"))+i.innerWidth()/2};console.log("getIconCenter(ele,ctr,box,child)",h,k,j,l);return k};this.install=function(h,k){var l=h.iconAnimationStart||{};switch(l.size||128){case 48:new Image().src=h.iconSrc;break;default:new Image().src=h.largeIconSrc;break;l.size=128}var i=$j(jive.nav.menu.apps.instances.renderAppInstanceLink({largeIconSrc:h.largeIconSrc,smallIconSrc:h.iconSrc,iconSize:l.size,url:"#",title:h.title})).css({position:"absolute","z-index":"9999"});i.find(".j-app-title").css({opacity:"0.001"});if(d.showMarkers){jive.Navbar.Menu.Apps.InstallAnimation.rt(0,0).prependTo(i)}k=k||{};k.left=k.left||$j(window).width()/2+$j(document).scrollLeft();k.top=k.top||$j(window).height()/2+$j(document).scrollTop();var j={start:{element:i,position:{x:k.left+(l.x||0),y:k.top+(l.y||0)},size:l.size},end:{selector:"li:has(#app-ql-"+h.appUUID+")"}};this.addToQueue(j);if(this._active==-1){this._active=0;this.begin()}};this.isAnimationRunning=function(){return this._animationRunning}});jive.Navbar.Menu.Apps.InstallAnimation.rt=function(b,e){var d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAQAAABu4E3oAAADCmlDQ1BJQ0MgcHJvZmlsZQAAeNqt0GlQjHEABvDnv9vulrZjabElvaHI1eHckLZaybkU2uTYtrUVdl+7b7ZzVwnjGCvSUJFc44gkx0RRTBmZSnIMOUthjElNE40hHxiNj2b8Pj3zfHlmHoC9RxIUIGXZA7SO0QUvlsjD5REUrx5csAEAUCj1tEQmmwcAGq1Ghb8RoPsxCAA0jpMEBUjxbzhKWscAqADgE63SKwF0AVAbGJoBSCQAh6i1NAMQGoDD2rDFgQDJAFh8RpXAAECglk7UxapjGMpbLBZTkmhtlIoKTdQzqvV6KkSj1OporU7BqKIB/N4AAJsgLUMFK2I11AQvN/xn4fII6lfq+6ev66OM1238cyVgDwpe8IcMq0EjDZkoQDEq0YA36CCECIgr8SYSsogoyAaSTvaSo+QiuUUekGbSyRKwprIUrJ2sq6xWtpA9i53APsdusXCyCLPYY1HL4XPmccycRq6Iq+Ce5X7hSXlZvDZLseVuy1YrP6uDVt39lvS7Yi2yNlq38hfwS23cbfbb8myTbNvt1Hav7SPtnwrkgqb+q/q3DdAM+OqwReggPDFQPLBu0JrBGJwn8hU1ORqdhjvVDGGcKee6oSYXH5d3VL5r+DDhsMbhWSOWuTm7tboXjUwZNddjiMfn0dVj8scmjVs2foqno2evV5v3fZ+yCWcn5k0yT946xTg1UWzwNUxLmm6asc0vc+Zh/3OSmwEPAz9KObNcg/1nK0K2zCmc+2g+WeC5cLUsa1FNKDts5pLUpTfCiXx2ROby5yvGrExZVa9wjzIpn6nEa3LUP2JVcXXrfNef1jrRZh1Xv4n5vjHV0JuYkcxPyTaOMF1KC05/kRG/VbCtaLtsR9eu3N1Sc0dmwb7Q/ZbZFQeSc8S5PYfK8zcXzD8mOv7+5LVT5jPqwoDzLhdQ3FJSc7nk6pFS8/X0csNNbWXc7ZiquDuau/H3TLW76vMaLjRWP3r15Nszx+czXka93tF8+e3bd8IPcz6mfSpr7+n07TJ2V/XYfYv8Xtjb+xNi+gXqNdAgEAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wDFxEhNwqAGqkAAAKVSURBVDjLfdRfaNVlGAfwz++4tmlj5YqNDNNtOJfTFsPmtFMiGPRHkklIkVEX7SK6UbIuKhiYQs4KpYskuoiobmLreBFkBzZT52ReSI6YXXShjmyRom6CnXP2e7s4v532j5735vk+z/vlfXmf7/ddZOFYY69r/lyotWgOrlCn1Q6d0uo1KFeQMzVzSzSL0OQFWyx12qRH/KpC2oQBvUYXOi9ll+O+8DhYbp9VYKOjsl5TNp+wV9aOEn5At/oS2ua4d+eSXpHVkeQP2qPXb09nGt+yMqm1+dHrMwnNsrYnebfLJgUhhDAZxuxP6s/ot3aaUKnb0ST/Tk4oriRybZmkd8R+i6cv0m89+EBOLJ5BiUMc8j4C65yyvEh5yiCoNyaIBbEJf4dbIQ4hxCGEP7SAAc+LUiLtToCX1CASXNTlUS8bEUSo6dwJ+rWT0miNG+rU6Ehuett7fvJsNOxtE0VNPLHBfercsFpjmS6tKlWb0oIgcsegV33i/uiIO6oFkSZ7xJo9rKvM91a5oE++M93XIEKF9iijVp91yhNRXfGNMs9ZIpNy1i+CERfvGfIPqHIgNC57X6WPVYO8YaNG5I0YIrJdf3HC4WryQnG46arrppIXHLcJ/ODFopAfMqgZln4eCiEOcQghGadYrOCrZAjnpnW3xEGHilY4MBAKxRGWRlow5C6wz2FVSqIb8GRR0Wu/DOMhn5xS8JdvlYMOP9sw02i7HUv8QfrDw5+ddMlpn9qS1Or1eWe2hxc7KGNjCa/Qo6mEHtPrkLtne7/gjFpvavC7m7hXqwuuYZnd3nBCj9vzvZ+y3i6bjMnK2eyMYKuVzvra8H9fRjTH0FVqpbVp1uCSUeedMp4o7X8iJdKiR5tIan77XzJSAOFH3IwfAAAAAElFTkSuQmCC";var c=$j("<img/>").attr("src",d).css({position:"absolute",left:(b-12)+"px",top:(e-12)+"px",width:"25px",height:"25px"});return $j("<div/>").css({position:"relative",overflow:"visible","z-index":"10001",visibility:""}).append(c).appendTo($j("body"))};return jive.Navbar.Menu.Apps.InstallAnimation});
;
jive.namespace("Navbar.Menu.Apps");define("apps/navbar/menu/apps/instances/animated_install",function(){var a=null;jive.Navbar.Menu.Apps.animatedInstall=function(c,f){var b=$j.browser.msie&&$j.browser.version<9;if(c.iconAnimationStart&&!b){if(!a){a=new jive.Navbar.Menu.Apps.InstallAnimation();var d=new jive.AppInstanceSource();a.addListener("begin",function(g){d.findAll({}).addCallback(function(h){g.emitSuccess(h)}).addErrback(function(){g.emitError()})});a.addListener("destroy",function(){a=null});a.offset=f}a.install(c,a.offset);return a.getPromise()}else{var e=new jive.conc.Promise();e.emitError();return e}};jive.Navbar.Menu.Apps.whenAnimationStarts=function(){var b=new jive.conc.Promise();if(a&&!a.isAnimationRunning()){a.addListener("animation.app-icon.start",function(){b.emitSuccess();jive.switchboard.emit("app.install.animation.started")})}else{b.emitError()}return b};jive.Navbar.Menu.Apps.whenAnimationEnds=function(){var b=new jive.conc.Promise();if(a){a.addListener("destroy",function(){b.emitSuccess();jive.switchboard.emit("app.install.animation.ended")})}else{b.emitError()}return b};return jive.Navbar.Menu.Apps});
;
define("jive/app/core_container/market_events",function(){return jive.oo.Class.extend(function(a){jive.conc.observable(this);this.init=function(){var b=this;this.addListener("market_hidden",this.marketClose.bind(this));this.addListener("app_install",this.appInstall.bind(this));this.addListener("app_uninstall",this.appUninstall.bind(this))};a.marketClose=function(){};a.appInstall=function(d,c,b){jive.switchboard.emit("apps_market.apps_have_changed")};a.appUninstall=function(c,d,b){jive.switchboard.emit("apps_market.apps_have_changed")}})});
;
define("jive/app/core_container/models/appscontainer_model",["jive/app/core_container/token_provider"],function(a){return jive.oo.Class.extend(function(b){jive.conc.observable(this);var c={};this.init=function(d){this.options=d};this.initContainerSecurityToken=function(d){a.getSecurityTokenDataPromise().then(function(g){var e=g.token;var f=g.ttl;d.updateContainerSecurityToken(function(){},e,f)})};this.getAuthToken=function(){return a.getSecurityTokenPromise()};this.getApp=function(k,d){var j=c[k];var g;var i=new jive.conc.Promise();var e=this;if(j&&!j.outdated){i.emitSuccess(j)}else{var h=function(l){j=e.cacheApp(l,false,k);i.emitSuccess(j)};var f=function(o){var l=null;if(o.status==404){try{var m=JSON.parse(o.responseText);if(m.appUUID){l=j=e.cacheApp(m,true)}}catch(n){}}i.emitError(l)};if(d){g=jive.api.apps("instances/appinstance");$j.ajax({url:g+"/"+d,contentType:"application/json",dataType:"json",type:"GET",cache:false,success:h,error:f})}else{if(k){g=jive.api.apps("instances/my");$j.ajax({url:g+"/"+k,contentType:"application/json",dataType:"json",type:"GET",cache:false,success:h,error:f})}}}return i};this.getAppsMarketApp=function(){var g=c.market;var e;var f=new jive.conc.Promise();var d=this;if(g){f.emitSuccess(g)}else{e=jive.api.apps("instances/market");$j.ajax({url:e,contentType:"application/json",dataType:"json",type:"GET",cache:false,success:function(h){g=d.cacheApp(h,true);f.emitSuccess(g)},error:function(h){f.emitError()}})}return f};this.getExtensionPublisherApp=function(){var g=c.publisher;var e;var f=new jive.conc.Promise();var d=this;if(g){f.emitSuccess(g)}else{e=jive.api.apps("instances/upload-app");$j.ajax({url:e,contentType:"application/json",dataType:"json",type:"GET",cache:false,success:function(h){g=d.cacheApp(h,true);f.emitSuccess(g)},error:function(h){f.emitError()}})}return f};this.cacheApp=function(j,f,h){j.appURL=null;if(j.src){var g=j.src.split("&");for(var e=0;e<g.length;e++){if(/^url=/.test(g[e])){j.appURL=decodeURIComponent(g[e].substr(4));break}}}else{if(j.url){j.appURL=j.url}}if(typeof j.nocache==="undefined"||j.nocache===null){var d=j.src?decodeURIComponent(j.src).match(/nocache=([01]{1})&/)[1]:"0";if(d==="1"){j.nocache=true}else{j.nocache=false}}h=f?"market":(h?h:j.appUUID);j=c[h]=c[h]?$j.extend(c[h],j):j;delete j.outdated;return j};this.deleteApp=function(e,d,f){d=d||function(){};f=f||function(){};var g=jive.api.apps("instances/instance/"+e);$j.ajax({url:g,contentType:"application/json",dataType:"json",type:"DELETE",success:d,error:f})};this.refreshApp=function(f,d,e){d=d||function(){};e=e||function(){};$j.ajax({url:f,dataType:"json",type:"POST",success:d,error:e})};this.appRemove=function(f,g,d,e){d=d||function(){};e=e||function(){};$j.ajax({type:"PUT",url:jive.api.apps("instances/"+f+"/"+g),success:d,error:e})};this.acknowledgeThrottle=function(f,d,e){d=d||function(){};e=e||function(){};$j.ajax({type:"PUT",url:jive.api.apps("instances/throttle/violation/"+f),success:d,error:e})};this.appHide=function(f,d,e){d=d||function(){};e=e||function(){};$j.ajax({type:"PUT",url:jive.api.apps("instances/hide/"+f),success:d,error:e})}})});
;
define("jive/app/core_container/main",["jive/app/app-file-uploader","jive/app/oauth/main","jive/app/core_container/views/credentials_view","jive/app/core_container/views/services_view","jive/app/core_container/market_events","jive/app/rte/artifacts","jive/app/core_container/shared","osapi","gadgets","jquery","jive/app/core_container/models/rtc_model"],function(g,b,a,e,i,d,f,j,h,c,k){return f.extend(function(l){jive.conc.observable(this);var n=new i();var m=new d();var o={LINK:"app.link.run",RTE:"app.rte.run",CONTENT:"app.content.run"};this.initEditContext=function(q){this.options.editedContentBean=q;var p=q.appContextBean;if(p){this.editContext={jive:{content:{type:p.coreAPIType,id:p.containerId<0?0:p.containerId}}}}};l.initializeEventHandlers=function(q){var p=this;c.each(q,function(s,r){p.modalView.addListener(r,function(t){p.handleRunAction(t,r)})});this.applyAppReloadHandlers(this.modalView);this.modalView.addListener("app.services.show",function(r){if(p.servicesView&&p.servicesView.isActive()){return}if(p.servicesView){delete p.servicesView}if(r){p.model.getApp(r).addCallback(function(s){p.servicesView=new e(s,p.commonContainer,p.options);p.servicesView.addListener("app.reload",function(){p.reloadApp()});p.model.getAppsMarketApp().addCallback(function(t){p.servicesView.setMarketApp(t);p.servicesView.addListener("app.services.close",function(){p.modalView.destroySettings();if(s.developerModel){p.modalView.setSparkline(s.developerModel.getMonitorState())}});p.modalView.invokeSettings(p.servicesView)})})}});this.modalView.addListener("app.chrome.close",function(){delete p.servicesView;if(p.credentialsView){p.credentialsView.cleanup();delete p.credentialsView}p.servicesView=null;p.credentialsView=null;p.oauthView=null});n.addListener("show_information",function(t,r,s){p.sendNotification(s,t)});n.addListener("app_install",function(v,t,u){var s=c.isArray(v)?(v.length?v[0]:null):v;if(p.postInstallActionRun){var x=p.postInstallActionRun.actionInfo;var y=p.postInstallActionRun.origin;var z=function(){if(p.postInstallActionRun&&s&&x&&y&&s.appUUID===s.appUUID){delete p.postInstallActionRun;p.handleRunAction(x,y);p.postInstallActionRun=null}jive.switchboard.removeListener("app.install.animation.ended",z)};jive.switchboard.addListener("app.install.animation.ended",z);setTimeout(z,4250)}else{var r=u[j.container.GadgetSite.RPC_ARG_KEY];var w=r.jiveData.mvcView;p.model.cacheApp(s,false);w.handleAppsMarketInstall(s)}});p.applyAppAlertHandlers(p.modalView);p.applyOAuthHandlers(p.modalView);p.applyRefreshHandlers(p.modalView);p.applyCredentialsHandlers(p.modalView);c(document).ready(function(){p.modalView.documentReady()})};l.applyAppReloadHandlers=function(r){var p=this;var q=function(){if(p.oauthView){delete p.oauthView}if(p.servicesView){delete p.servicesView}if(p.credentialsView){delete p.credentialsView}};r.addListener("app.reload",function(s){q();p.reloadApp(s)})};l.applyOAuthHandlers=function(q){var p=this;q.addListener("app.oauth.show",function(r){if(p.oauthView){return}p.oauthView=new b(r.app,r.options.alias,r.options.redirectURI,r.options.windowChars,r.callback);q.invokeOauthDance(p.oauthView);p.oauthView.addListener("popup.closed",function(){delete p.oauthView})})};l.applyRefreshHandlers=function(q){var p=this;q.addListener("app.services.refresh",function(r){var t=c(r).attr("data-appuuid");var s=c(r).attr("data-endpoint");p.model.refreshApp(s,function(){q.refresh()},function(){q.displayRefreshMsg(false)})})};l.applyCredentialsHandlers=function(q){var p=this;q.addListener("app.credentials.show",function(r){if(p.credentialsView){return}p.credentialsView=new a(r);q.invokeCredentials(p.credentialsView);p.credentialsView.addListener("app.credentials.complete.error",function(){q.closeModal()});p.credentialsView.addListener("app.credentials.complete.success",function(){q.destroyCredentials();delete p.credentialsView});p.credentialsView.addListener("app.service.message",function(s){q.sendNotification(s)})})};l.applyAppAlertHandlers=function(q){var p=this;q.addListener("app.remove.banned",function(t,r,s){p.model.appRemove("ban",t.id,r,s);jive.switchboard.emit("apps_market.apps_have_changed")});q.addListener("app.remove.blacklisted",function(t,r,s){p.model.appRemove("blacklist",t.id,r,s);jive.switchboard.emit("apps_market.apps_have_changed")});q.addListener("app.remove.throttle.violation",function(t,r,s){p.model.acknowledgeThrottle(t.id,function(){r();p.reloadApp(false)},s)});q.addListener("app.hide",function(t,r,s){p.model.appHide(t.id,r,s);jive.switchboard.emit("apps_market.apps_have_changed")});q.addListener("app.refresh",function(){p.reloadApp(false)});q.addListener("app.delete",function(t,r,s){p.model.deleteApp(t.appInstanceUUID,r,s);jive.switchboard.emit("apps_market.apps_have_changed")})};l.rpcRegister=function(){var p=this;this.commonContainer.rpcRegister("maximize_app",p.maximizeApp.bind(p));this.commonContainer.rpcRegister("get_launch_context",p.getLaunchContext.bind(p));this.commonContainer.rpcRegister("editor_insert",p.editorInsert.bind(p));this.commonContainer.rpcRegister("request_core_api_upload",p.requestCoreApiUploadMediaItem.bind(p));this.commonContainer.rpcRegister("fire_market_events",p.fireMarketEvents.bind(p));this.commonContainer.rpcRegister("build_artifact_markup",p.buildArtifactMarkup.bind(p));this.commonContainer.rpcRegister("host_app_icon",p.uploadAppIcon.bind(p));this.commonContainer.rpcRegister("gather_oauth_credentials",p.gatherOAuthCredentials.bind(p));this.commonContainer.rpcRegister("halt_app",p.gatherCredentials.bind(p));this.commonContainer.rpcRegister("editing_finished",p.editingFinished.bind(p));this.commonContainer.rpcRegister("editing_canceled",p.editingCanceled.bind(p));this.commonContainer.rpcRegister("jive.event",p.jiveEvent.bind(p))};this.renderCanvasView=function(q){var p=this;require(["jive/app/core_container/views/canvas_view","shindig"],function(u,v){l.loadCanvasView(p,u);var s=q.appInstanceView.params?JSON.parse(q.appInstanceView.params):null;if(q.viewParamsToken!==null){var t=q.viewParamsToken;if(t.view!==null){q.appInstanceView.view=t.view}if(t.params!==null){s=t.params}}if(q.isMarketApp){q.marketContext=p.buildMarketContext(q.appInstanceView,p.canvasView,q.marketInitialToken);q.marketContext=p.canvasView.getEmbeddedContext(q.marketContext.embeddedID);q.marketContext.target.view="default"}var r;if(q.launchContext){r={jive:{content:{type:q.launchContext.coreAPIType,id:q.launchContext.id},context:q.launchContext.context}}}p.model.getAuthToken().then(function(){p.model.cacheApp(q.appInstanceView,q.isMarketApp);p.canvasView.render(q.appInstanceView,s,q.marketContext,function(w){},r)},function(){window.location.reload()})})};this.renderRtcView=function(q){var p=this;require(["jive/app/core_container/views/rtc_view","shindig"],function(t,v){var s=q.appInstanceView.appUUID+"::"+q.appInstanceView.view;if(k.rtcViews[s]){p.closeGadget(k.rtcViews[s]);delete k.rtcViews[s]}var u=new t(p.commonContainer,{});p.applyAppReloadHandlers(u);p.applyAppAlertHandlers(u);p.applyOAuthHandlers(u);p.applyRefreshHandlers(u);p.applyCredentialsHandlers(u);p.addRTCListener();var r;if(q.launchContext){r={jive:{content:{type:q.launchContext.coreAPIType,id:q.launchContext.id},context:q.launchContext.context}}}p.model.getAuthToken().then(function(){p.model.cacheApp(q.appInstanceView,q.isMarketApp);u.render(q.appInstanceView,q.marketContext,function(x,w){k.rtcViews[s]=w},p.determineContainerContext())},function(){})})};this.addRTCListener=function(){jive.switchboard.addListener("apps.jive.event",function(p){console.log("event details are "+JSON.stringify(p));require(["appContainer"],function(r){if(r.isRTCView(p.appUUID,p.view)){if(p.eventId=="presence-event-display"&&p.eventData&&p.eventData.id){var q=$j("#j-profile-presence-"+p.eventData.id+", #j-hovercard-presence-"+p.eventData.id);if(q.length){q.show().attr("class","").addClass("j-profile-presence j-presence-"+p.eventData.status);q.find(".j-presence-display").text(p.eventData.display)}}}})})};this.sendRtcMessageToAll=function(q,r,t){for(idViewKey in k.rtcViews){var s=idViewKey.split("::")[0];var p=idViewKey.split("::")[1];this.sendRtcMessage(s,p,q,r,t)}};this.isRTCView=function(r,p){var q=r+"::"+p;if(k.rtcViews[q]){return true}return false};this.sendRtcMessage=function(w,q,s,u,v){var r=w+"::"+q;if(k.rtcViews[r]){var p=k.rtcViews[r];var t={id:s,data:u};h.rpc.call(p.getActiveSiteHolder().getIframeId(),"jive.event",function(x){if(v){v({appUUID:w,view:q,eventId:s,eventData:u,returnValue:x})}},t)}};l.loadCanvasView=function(p,q){if(typeof(p.canvasView)=="undefined"){p.canvasView=new q(p.commonContainer,{});this.bindActionOriginEnum(p.canvasView.getActionOriginEnum());p.applyAppReloadHandlers(p.canvasView);p.applyAppAlertHandlers(p.canvasView);p.applyOAuthHandlers(p.canvasView);p.applyRefreshHandlers(p.canvasView);p.applyCredentialsHandlers(p.canvasView);p.canvasView.addListener("app.services.show",function(r){if(p.servicesView&&p.servicesView.isActive()){return}p.servicesView=new e(r,p.commonContainer,p.options);p.model.getAppsMarketApp().addCallback(function(s){p.servicesView.setMarketApp(s);p.canvasView.invokeSettings(p.servicesView,r);p.servicesView.addListener("app.services.close",function(){p.canvasView.destroySettings()})});p.servicesView.addListener("app.reload",function(){p.reloadApp()})});p.canvasView.addListener("app.canvas.modal.close",function(){delete p.servicesView;if(p.credentialsView){p.credentialsView.cleanup();delete p.credentialsView}p.servicesView=null;p.credentialsView=null;p.oauthView=null})}};l.determineContainerContext=function(){var r=c.extend(true,{},this.editContext||this.actionLinkContext);if(jive.discussions&&jive.discussions.instance){r.jive.content.type="osapi.jive.core.Discussion";r.jive.content.id=jive.discussions.instance.getObjectId()}if(this.modalView.getCommentContext()!=null){r.jive.content=c.extend(this.modalView.getCommentContext().content,{parent:r.jive.content})}else{if(this.modalView.getInboxEntryContext()!=null){r.jive.content=this.modalView.getInboxEntryContext().content}else{if(this.modalView.getActivityStreamContext()!=null){r.jive.content=this.modalView.getActivityStreamContext().content}else{if(jive.advancedComment&&jive.advancedComment.instance){var q=jive.advancedComment.instance.getAppContext();c.extend(r.jive.content,{id:jive.advancedComment.instance.getObjectId(),parent:{id:q.containerId,type:q.coreAPIType},type:"osapi.jive.core.Message"});c.extend(r.jive.content,function(s){return s?{inReplyTo:{id:s.id,type:"osapi.jive.core.Message"}}:{}}(jive.advancedComment.instance.getParent()))}else{var p=this.editContext?this.editContext.jive:undefined;p=p||this.actionLinkContext.jive;c.extend(r.jive,p)}}}}return r};l.determineRTEContext=function(){return this.rteContext};l.maximizeApp=function(q){var p=q[j.container.GadgetSite.RPC_ARG_KEY];p.jiveData.mvcView.maximizeApp(p)};l.getLaunchContext=function(q){var p=q[j.container.GadgetSite.RPC_ARG_KEY];if(q.callback){q.callback(p.jiveData.getLaunchContext())}};l.gatherCredentials=function(r,q){var p=r[j.container.GadgetSite.RPC_ARG_KEY];var s=p.jiveData.app;p.jiveData.mvcView.emit("app.credentials.show",{app:s,callback:r.callback,args:q})};l.gatherOAuthCredentials=function(r,q){var p=r[j.container.GadgetSite.RPC_ARG_KEY];var s=p.jiveData.app;p.jiveData.mvcView.emit("app.oauth.show",{app:s,callback:r.callback,options:q})};l.requestCoreApiUpload=function(q,s,p,r){p=p||{};new g(this,s,p,r,q.callback)};l.requestCoreApiUploadMediaItem=function(q,s,p,r){this.requestCoreApiUpload(q,s,p,r)};l.setTitle=function(q,s){var p=q[j.container.GadgetSite.RPC_ARG_KEY];var r=p.jiveData.app;p.jiveData.mvcView.setTitle(s)};l.editingFinished=function(r,q){var p=r[j.container.GadgetSite.RPC_ARG_KEY];var s=p.jiveData.app;if(q&&q.message){p.jiveData.mvcView.emit("app.service.message",{message:q.message})}p.jiveData.mvcView.emit("app.services.close");this.reloadApp()};l.editingCanceled=function(r,q){var p=r[j.container.GadgetSite.RPC_ARG_KEY];var s=p.jiveData.app;if(q&&q.message){p.jiveData.mvcView.emit("app.service.message",{message:q.message})}p.jiveData.mvcView.emit("app.services.close")};l.jiveEvent=function(q,p){jive.switchboard.emit("apps.jive.event",{appUUID:q.gs.jiveData.app.appUUID,view:q.gs.jiveData.app.view,eventId:p.id,eventData:p.data});console.log("Container received "+p.id+" with data "+JSON.stringify(p.data))};l.editorInsert=function(t,s){var r=t[j.container.GadgetSite.RPC_ARG_KEY];var p=r.jiveData.mvcView;if(typeof(s.html)!=="undefined"&&this.appActionDataPromise){var q=new d();q.makeArtifactURLsAbsolute(s,r.jiveData.app);this.appActionDataPromise.resolve(s,t,this.options.editedContentBean)}l.scheduleModalClose(p,s)};l.sendNotification=function(t,s){var r=t?t[j.container.GadgetSite.RPC_ARG_KEY]:null;s=s||{};if(typeof(s.message)!=="undefined"){if(typeof(s.severity)!=="undefined"){s.severity=s.severity.toLowerCase();if(!(s.severity in {error:1,info:1,success:1})){throw"Invalid severity: must be 'error', 'info' or 'success'"}}}if(r){var p=r.jiveData.mvcView;p.sendNotification(s)}else{s=s||{};var u=s.message;var q=s.severity||"info";if(typeof(u)!="undefined"){c("<p/>").html(u).message({style:q})}}};this.reloadApp=function(p){var r=this;function q(){if(r.modalView){r.modalView.reload(function(t,u){pendingActions[u.actionId]=t.getActiveSiteHolder().getIframeId()})}if(r.canvasView){r.canvasView.reload()}}if(p){q()}else{var s=this.modalView.getRenderedApp()||(this.canvasView&&this.canvasView.getRenderedApp());if(s){s.outdated=true;this.model.getApp(s.appUUID).addCallback(function(t){r.preCacheAppResources(t);q()})}}};this.handleRTEActionSelect=function(r,p,q){this.appActionDataPromise=q;this.rteContext=p;this.modalView.handleCreateActionSelect(r,o.RTE)};this.handleRTEActionContextEdit=function(s,p,t,r){this.appActionDataPromise=r;this.rteContext=p;var q={actionId:s.id,appURL:s.appURL,appInstanceUUID:s.appInstanceUUID,appUUID:s.appUUID,label:s.label,selectionType:"",selectionID:"",view:s.view,currentArtifact:t};this.modalView.handleEditActionSelect(q,o.RTE)};this.handleMarketContext=function(t){var s=this;var r=null;this.appActionDataPromise=c.Deferred();this.appActionDataPromise.done(function(w,v){if(w){r=c("#"+v.f);s.fireMarketEventsImpl(w.events,r,v)}});var u=function(){n.emit("market_shown")};var q=function(){n.emit("market_hidden")};var p={};if(typeof t==="string"){p.initialToken=t}else{if(t){p=t}else{p={}}}s.model.getAppsMarketApp().addCallback(function(w){var v=s.buildMarketContext(w,s.modalView,t);s.modalView.render(w,v,null,u,q,p)})};this.buildMarketContext=function(u,t,q){var s=this.buildJiveContextForMarket(q);if(typeof q==="string"){this.hackInitialTokenIntoMarketContext(q,s.market)}var r=t.prepareMarketContext(s);if(q&&q.view){var p=t.getEmbeddedContext(r.embeddedID);if(p){p.target.view=q.view}}return r};this.getMarketEvents=function(){return n};l.buildJiveContextForMarket=function(q){var p=q&&q.embeddedID&&this.modalView.getEmbeddedContext(q.embeddedID);var r=(p&&p.jive)?c.extend({},p.jive):{};r.market={experience:q.experience||"default"};if(q.appUUID){r.market.appUUID=q.appUUID}if(q.appFilter){r.market.appFilter=q.appFilter}if(q.appShortName){r.market.appShortName=q.appShortName}if(q.isDevelopmentApp){r.market.isDevelopmentApp=q.isDevelopmentApp}if(q.alternateUrl){r.market.alternateUrl=q.alternateUrl}return r};l.hackInitialTokenIntoMarketContext=function(s,r){var p=s.split(";");r.experience=p[0]||"default";for(var q=1;q<p.length;q++){var t=p[q].split("=",2);if(t[1]){if(t[0]=="uuid"){r.appUUID=t[1]}else{if(t[0]=="name"){r.appFilter=t[1]}}}}};this.removeAppFromPage=function(p){this.commonContainer.closeGadget(p)};l.ensureHasMarketFeature=function(p){if(!c("#"+p).data("hasMarketFeature")){throw"Unauthorized call to market restricted RPC function"}};l.fireMarketEvents=function(p,q){this.ensureHasMarketFeature(p.f);if(q&&q.events){this.fireMarketEventsImpl(q.events,c("#"+p.f),p)}};l.fireMarketEventsImpl=function(s,u,q){if(s&&s.length){for(var r=0,p=s.length;r<p;++r){var t=s[r];if(t&&t.eventName){n.emit(t.eventName,t.eventData,u,q)}}}};l.buildArtifactMarkup=function(q,p){m.buildArtifactMarkup(q,p)};l.uploadAppIcon=function(r,q){var p=r?r[j.container.GadgetSite.RPC_ARG_KEY]:null;var v=r.callback;var u=p.jiveData.app;var s=q.iconUrl;var t=m.uploadArtifactIcon(s,u.appInstanceUUID);t.addCallback(function(w){v(w)}).addErrback(function(w){if(console){console.log("error uploading "+s,w)}v()})}})});
;
define("jive/app/core_container/views/modal_comment_provider",["jquery","lib/jiverscripts/src/conc/observable"],function(c,a){function b(){var h={type:"osapi.jive.core.Comment"};var i={type:"osapi.jive.core.Message"};var e=this;this.commentContext=null;this.activityStreamContext=null;this.getCommentContext=function(){return this.commentContext};this.getActivityStreamContext=function(){return this.activityStreamContext};this.getInboxEntryContext=function(){return this.activityStreamContext};var g=function(k){var j={content:{}};c.extend(j.content,k,h);if(j.content.inReplyTo){c.extend(j.content.inReplyTo,h)}return j};this.setCommentContext=function(j){e.commentContext=g(j)};var d=function(k){var j={content:{}};c.extend(j.content,{id:0},i);if(k.isReply){c.extend(j.content,{inReplyTo:{id:k.parentMessageId}});j.content.parent=k.parent}if(j.content.inReplyTo){c.extend(j.content.inReplyTo,i)}return j};this.setDiscussionContext=function(j){e.commentContext=d(j)};var f=function(j){var k="osapi.jive.core.Unsupported("+j+")";switch(j){case 2:case"2":k="osapi.jive.core.Discussion";break;case 38:case"38":k="osapi.jive.core.Post";break;case 102:case"102":k="osapi.jive.core.Document";break;case 105:case"105":k="osapi.jive.core.Comment";break}return k};this.setActivityStreamContext=function(k){var j;switch(k.objectType){case"2":j=d({discussionId:k.parent.jiveObject.id,parentMessageId:k.objectID,isReply:true,parent:{id:k.parent.jiveObject.threadID,type:f(k.objectType)}});break;case"18":j=g({id:0,parent:{id:k.parent.jiveObject.id,type:f(k.objectType)}});break;case"38":j=g({id:0,parent:{id:k.parent.jiveObject.id,type:f(k.objectType)}});break;case"102":j=g({id:0,parent:{id:k.parent.jiveObject.id,type:f(k.objectType)}});break;case"105":j=g({id:0,inReplyTo:{id:k.objectID,type:f(k.objectType)},parent:{id:k.parent.jiveObject.id,type:f(k.parent.jiveObject.objectType)}});break}e.activityStreamContext=j}}a(b.prototype);return b});
;
define("modalCommentProviderSingleton",["jive/app/core_container/views/modal_comment_provider"],function(a){if(!a.singleton){a.singleton=new a()}return a.singleton});define("jive/app/core_container/views/modal_view",["jquery","jive/app/core_container/views/appscontainer_view","jive/app/alert/main","modalCommentProviderSingleton","apps/shared/controllers/localexchange"],function(d,a,c,e,b){return a.extend(function(g,j){jive.conc.observable(this);var k={LINK:"app.link.run",RTE:"app.rte.run",CONTENT:"app.content.run",PROFILE:"app.profile.run"};var h;var f;var i={width:0,height:0};this.init=function(n,o){j.init.call(this,n,o);this.commentContext=null;this.activityStreamContext=null;this.modalCommentProvider=e;var m=this;this.initClickHandler();jive.localexchange.addListener("renderedContentWithSelector",function(p,q){m.checkForLoadTimeView()});this.resizeToLatest=function(){if(i.width){m.resizeContainerWidth(i.width,false)}if(i.height){m.resizeContainerHeight(i.height,false)}};d(window).bind("resize",this.resizeToLatest);d(window).bind("scroll",function(){m.recenterModal(false)});var l=null;m.appFrame={css:function(p,r){var q=p;if(arguments.length=2){q={};q[p]=r}l=d.extend(l||{},q)},animate:function(p){l=d.extend(l||{},p)},applyCSS:function(p){if(l){p.css(l)}l=null}};b.addListener("app.action.create.link",function(q){var p=(q.actionOriginEnum?k[q.actionOriginEnum]:null)||k.LINK;m.fireActionEvent(p,{actionId:q.actionId,appURL:q.appUrl,appInstanceUUID:q.appInstanceUuid,appUUID:q.appUuid,label:q.label,selectionType:q.selectionType,selectionID:q.selectionId,view:q.view})})};g.handleAppAlert=function(m){var n=m.getActiveAlert();var l=this;l.hideChromeNav();d(".j-modal-back-top").hide();g.revokeStaticModalDimensions();if(n.code==1000||n.code==1010){this.handleConfigurationDialog(m,{configureCallback:function(o){l.restoreChromeNav();l.restoreStaticDimensions()}});l.recenterModal(false);return}m.applyBlock();l.recenterModal(false);g.setStaticDimensions(650,280,false);m.addListener("app.block",function(o){m.routeActionClicks(o,function(){l.handleConfigurationDialog(m)},function(){l.closeModal()},function(){l.closeModal();var p=jive.apps.container.renderMessage({messageKey:"error.general"});l.sendNotification({severity:"error",message:p})},l)})};this.documentReady=function(){this.checkForLoadTimeView()};this.getCommentContext=function(){return this.modalCommentProvider.getCommentContext()};this.getActivityStreamContext=function(){return this.modalCommentProvider.getActivityStreamContext()};this.getInboxEntryContext=function(){return this.modalCommentProvider.getInboxEntryContext()};this.getActionOriginEnum=function(){return k};this.handleCreateActionSelect=function(n,l){var m=n.data();this.fireActionEvent(l,{actionId:m.actionId,appURL:m.appUrl,appInstanceUUID:m.appInstanceUuid,appUUID:m.appUuid,label:d.trim(n.find("span.label").text()),selectionType:m.selectionType,selectionID:m.selectionID,view:m.view})};this.handleEditActionSelect=function(m,l){this.fireActionEvent(l,m)};g.fireActionEvent=function(l,m){this.emit(l,m)};this.handleEmbeddedView=function(o,n,l){var m=o;this.emit(n,{appUUID:m.attr("__appuuid"),isDevelopment:m.hasClass("j-apps-developerApp"),label:d.trim(m.text()),context:JSON.parse(m.attr("__context")||"{}"),view:m.attr("__view"),url:m.attr("__url")||"",embeddedID:l})};this.filterTitle=function(l,n){var m=(n?n:i.width)/8-9;l=l.length>m?(l.substring(0,m)+" ..."):l;return l};this.resetTitle=function(n,m){if(!(this.fullTitle||n||f)){return}var l=this.fullTitle?this.fullTitle:this.getRealTitle(n?n:f.jiveData.app);l=this.filterTitle(l,m);this.setModalTitle(l)};this.render=function(v,m,C,u,l,p){var y=this;var q=u||function(){};var s=p||{};var t=(m&&m.embeddedID)?m.embeddedID:"";var n=y.getEmbeddedContext(t);var w=function(){y.resetTitle(v);var D=h.find(".jive-modal-content")[0];if(n&&n.target.type&&n.target.type==="embed"){var E=y.renderAppEE_(D,v,n,function(G,F){f=G;G.jiveData=new JiveSiteData(y,v,s);G.jiveData.setGadgetMetaData(F);G.jiveData.setActionInfo(m);G.jiveData.setEEContext(n);y.renderModalCallback(F,G,v,q);y.registerModalEventHandlers();if(o){y.recenterModal()}},s);if(!E){f=y.commonContainer.newGadgetSite(D);f.jiveData=new JiveSiteData(y,v,s);f.jiveData.setSelection(C);f.jiveData.setActionInfo(m);f.jiveData.setEEContext(n)}}else{f=y.commonContainer.newGadgetSite(D);f.jiveData=new JiveSiteData(y,v,s);f.jiveData.setSelection(C);f.jiveData.setActionInfo(m);y.renderApp_(f,v,function(F){f.jiveData.setGadgetMetaData(F);y.renderModalCallback(F,f,v,q);y.registerModalEventHandlers();if(o){y.recenterModal()}},s)}};if(!h){this.html=d(jive.apps.container.chromeApp({app:v}));var B=this.html.find("#j-app-modal-parent");var x=v.view;if(n&&n.target){x=n.target.view?n.target.view:"embedded"}var r=this.computeAppDimensions(v,x);var A=r.width;var z=r.height;var o=true;if(A>0){o=false;B.css({width:(A+"px")})}if(z>0){o=false;B.css({height:(z+"px")})}i.height=r.isMaximum?"max":z;i.width=r.isMaximum?"max":A;h=this.html.lightbox_me({closeSelector:".close",destroyOnClose:true,centered:true,modalCSS:{top:"0px"},initialFocusSelector:"#jive-app-settings",onLoad:function(){jive.conc.nextTick(w.bind(y))},onClose:function(){h=null;y.closeApp_(true,true);y.rendered=false;if(typeof l==="function"){l()}}})}else{w();this.restoreStaticDimensions()}};this.setTitle=function(l){this.fullTitle=l;this.setModalTitle(this.filterTitle(l))};g.registerModalEventHandlers=function(){var l=this;if(d.browser.msie&&d.browser.version<8){l.appFrame.css({marginBottom:0})}d(".j-modal-gear-top").unbind("click").click(function(m){l.hideChromeNav();var n=d(m.currentTarget).attr("data-appuuid");l.emit("app.services.show",n);m.preventDefault()});d(".j-modal-refresh-top").unbind("click").click(function(m){l.emit("app.services.refresh",m.currentTarget);m.preventDefault()})};g.restoreChromeNav=function(){d(".j-modal-gear-top").show();d(".j-modal-refresh-top").show();d(".j-modal-back-top").hide()};g.hideChromeNav=function(){d(".j-modal-gear-top").hide();d(".j-modal-refresh-top").hide();d(".j-modal-back-top").show()};this.maximizeApp=function(){var l=this;this.resizeMax(false)};this.resizeMax=function(l){this.resizeContainerHeight("max",l);this.resizeContainerWidth("max",l)};this.getRenderedApp=function(){return f?f.jiveData.app:null};this.reload=function(m){if(!f){return}var l=f.jiveData;this.closeApp_(false,false);l.app.view=l.getAppView();this.render(l.app,l.getActionInfo(),l.getSelection(),function(n){m(n,l.getActionInfo())},null,l.viewParams)};this.closeModal=function(l){l=l||{};this.closeApp_(true,true);this.html.find(".close").click();h=null;this.rendered=false;if(typeof(l.navigateTo)!="undefined"){var m=l.navigateTo;if(!(/^http(s)?\:\/\//i.test(m))){if(!m.startsWith("/")){m="/"+m}if(!m.startsWith(window._jive_base_url)){m=window._jive_base_url+m}}window.location.href=m}};this.closeApp_=function(l,m){if(l){this.emit("app.chrome.close")}if(f){this.commonContainer.closeGadget(f)}f=null;if(m){this.html.find("#j-app-modal-parent").css({width:"",height:""});i={width:0,height:0};this.appStaticDimensions=null;this.notPrimary=false;this.fullTitle=null}};g.getChromeHeight=function(){if(!this.rendered){return 43}var l=this.html.outerHeight();var m=this.appFrame.height();return l-m};g.getChromeWidth=function(){if(!this.rendered){return 10}var m=this.html.outerWidth();var l=this.appFrame.width();return m-l};this.getMaximumHeight=function(){return d(window).height()-g.getChromeHeight()};this.getMaximumWidth=function(){return d(window).width()-g.getChromeWidth()};this.resizeContainerHeight=function(q,l){l=!(d.browser.msie&&d.browser.version<9)&&l;if(this.notPrimary){return}if(q!=="max"&&q<this.bounds.minHeight){q=this.bounds.minHeight}var m=d("#j-app-modal-parent iframe").height();if(m===q){return}if(q!=="max"&&q>this.bounds.maxHeight){q="max"}var o=g.getChromeHeight(),s=this.bounds.minHeight,r=this.getMaximumHeight();var p=q==="max";if(p){q=r}i.height=p?"max":q;var t=this;var n;l=l&&q<(r/2);if(l){d("#j-app-modal-parent")[l?"animate":"css"]({height:(q+"px")},{duration:100,queue:false});n=Math.min(Math.max(q,s),r);t.lastResizeTs=new Date().getTime();d(t.html).animate({position:"fixed",top:"50%",marginTop:d(t.html).outerHeight()/-2},{duration:100,queue:false});d(t.html).animate({marginTop:(n/-2)-o/2},{duration:100,queue:false});t.appFrame.animate({height:n},{duration:100,queue:false})}else{d("#j-app-modal-parent").css({height:(q+"px")});n=Math.min(Math.max(q,s),r);t.lastResizeTs=new Date().getTime();d(t.html).css({position:"fixed",top:"50%",marginTop:d(t.html).outerHeight()/-2});d(t.html).css({marginTop:(n/-2)-o/2});t.appFrame.css({height:n})}};this.resizeContainerWidth=function(s,m){m=!(d.browser.msie&&d.browser.version<9)&&m;if(this.notPrimary){return}if(s!=="max"&&s<this.bounds.minWidth){s=this.bounds.minWidth}var n=d("#j-app-modal-parent iframe").width();if(n===s){return}if(s!=="max"&&s>this.bounds.maxWidth){s="max"}var o=this.bounds.minWidth,q=this.getMaximumWidth();var p=s==="max";if(p){s=q}i.width=p?"max":s;var l=this;var r=d(l.html).outerWidth();if(m){d("#j-app-modal-parent")[m?"animate":"css"]({width:(s+"px")},{duration:100,queue:false});modalWidth=Math.min(Math.max(s,o),q);l.lastResizeTs=new Date().getTime();d(l.html).animate({position:"fixed",left:"50%",marginLeft:d(l.html).outerWidth()/-2},{duration:100,queue:false});d(l.html).animate({marginLeft:(modalWidth/-2)-4},{duration:100,queue:false});l.appFrame.animate({width:modalWidth},{duration:100,queue:false});l.resetTitle()}else{d("#j-app-modal-parent").css({width:(s+"px")});modalWidth=Math.min(Math.max(s,o),q);l.lastResizeTs=new Date().getTime();d(l.html).css({position:"fixed",left:"50%",marginLeft:r/-2});d(l.html).css({marginLeft:(modalWidth/-2)-4});l.appFrame.css({width:modalWidth});l.resetTitle()}};g.renderModalCallback=function(n,o,q,m){var l=this;var r=m||function(){};if(n.error){}else{var p=h.find("iframe");if(l.appFrame.applyCSS){l.appFrame.applyCSS(p)}l.appFrame=p;l.appFrame.removeData();if(q.marketFeatureAvailable){l.appFrame.data("hasMarketFeature",true);d(".j-modal-gear-top").hide()}if(q.actionHeight===9999&&q.actionWidth===9999){l.appFrame.css({height:l.getMaximumHeight(),width:l.getMaximumWidth});l.resetTitle()}else{if(q.actionHeight&&q.actionWidth){l.appFrame.css({height:l.boundedHeight(q.actionHeight?q.actionHeight:0),width:l.boundedWidth(q.actionWidth)})}}l.rendered=true;r.call(l,o)}};this.requestNavigateTo=function(p,l,n,m,q){var o=this;p.view=n;l.jiveData=new JiveSiteData(o,p,m);this.renderApp_(l,p,function(r){o.renderModalCallback(r,l,p,q)},m)};this.scrollIntoView=function(r,q){var m=q||{};var o=m.bottomOffset;var l=m.verticalAlignment==null?"bottom":m.verticalAlignment;var p=d("#"+r).parents(".js-app-chrome");var n;if(l==="top"){n=-8}else{if(l==="center"||l==="middle"){n=(20+p.height()-d(window).height())/2}else{if(isFinite(l)){n=Number(l)}else{o=isFinite(o)?Number(o):0;n=5-o+p.height()-d(window).height()}}}d.scrollTo(p,{duration:500,offset:{left:0,top:n}})};g.restoreAppIframe=function(){var l=this;this.html.find(".j-app-modal-content").remove();g.restoreStaticDimensions();d("#j-app-modal-parent iframe").css({display:"block"});this.recenterModal(false)};g.resizeModal=function(l,o,n){n=!(d.browser.msie&&d.browser.version<9)&&n;var m=this.html.find(".j-app-modal-content");this.html.css({position:"fixed",top:"50%",marginTop:this.html.outerHeight()/-2,left:"50%",marginLeft:this.html.outerWidth()/-2});this.html[n?"animate":"css"]({marginLeft:o/-2,marginTop:l/-2},{duration:300,queue:false});m[n?"animate":"css"]({width:o,height:l},{duration:300,queue:false})};g.recenterModal=function(l){g.recenter(d("#jive-modal-appAction"),l)};this.invokeSettings=function(l){var m=this;g.invokeNonPrimarySurface(m,function(){g.revokeStaticModalDimensions();m.hideChromeNav();d("#j-app-modal-parent iframe").css({display:"none"});var n=l.createUI();d("#j-app-modal-parent").append(n);m.resizeModal(550,600,false);m.resetTitle(null,500);l.activate()})};this.destroySettings=function(){this.notPrimary=false;this.restoreChromeNav();this.restoreAppIframe();this.resetTitle()};this.invokeCredentials=function(m){var l=this;g.invokeNonPrimarySurface(l,function(){l.hideChromeNav();g.revokeStaticModalDimensions();d("#j-app-modal-parent iframe").css({display:"none"});var n=m.createUI();d("#j-app-modal-parent").append(n);d(".j-modal-back-top").hide();l.resizeModal(200,540,true);l.resetTitle(null,480);m.activate()})};this.destroyCredentials=function(){this.notPrimary=false;this.restoreChromeNav();this.restoreAppIframe();this.resetTitle()};this.invokeOauthDance=function(m){var l=this;g.invokeNonPrimarySurface(l,function(){l.hideChromeNav();g.revokeStaticModalDimensions();d("#j-app-modal-parent iframe").css({display:"none"});d(".j-modal-back-top").hide();var r=m.getApp();var q=new c(r);var p={appTitle:r.title,code:2060,message:"",creator:"",errorMessage:"",iconSrc:r.iconSrc};var n=d("#j-app-modal-parent");var o=q.applyBlock(n,r,p);l.recenterModal(false);m.launch_popup(d(o));m.addListener("popup.closed",function(){d(o).remove();l.restoreChromeNav();l.restoreAppIframe();g.restoreStaticDimensions();l.notPrimary=false;m.invokeCallback()})})};g.invokeNonPrimarySurface=function(l,m){if(l.notPrimary){return false}l.notPrimary=true;g.delayedRunner(m,150,function(){var n=new Date().getTime();return(!l.lastResizeTs||n-l.lastResizeTs>300)})};g.revokeStaticModalDimensions=function(l,n){l=!(d.browser.msie&&d.browser.version<9)&&l;var m=d("#j-app-modal-parent");this.appStaticDimensions={width:m.width()+"px",height:m.height()+"px"};m[l?"animate":"css"]({width:"",height:""},300,n||function(){})};g.restoreStaticDimensions=function(l,m){if(this.appStaticDimensions){g.setStaticDimensions(this.appStaticDimensions.width,this.appStaticDimensions.height,l)}};g.setStaticDimensions=function(n,l,m){m=!(d.browser.msie&&d.browser.version<9)&&m;var o=d("#j-app-modal-parent");if(m){o.animate({width:n,height:l},300,callback||function(){})}else{o.width(n).height(l)}};g.initClickHandler=function(){var l=this;d(document).off("click.embeddedAppArtifact").on("click.embeddedAppArtifact","a.jive_macro_appEmbeddedView",function(p){var o=d(this);var n=l.buildEmbedContext(o);var r=o.attr("__appuuid")||"";var q=o.attr("__action_id")||"";var m=o.attr("id")||String(Math.random());l.setEmbeddedContext(m,n);l.setEmbeddedContext("latest",n);if(r.length==36&&n.target&&n.target.type=="embed"){p.preventDefault();l.handleEmbeddedView(o,k.CONTENT,m)}})};this.checkForLoadTimeView=function(){var m=this.getEmbeddedExperienceToShowOnLoad();if(m){var l=d("#"+m).filter("a.jive_macro_appEmbeddedView");if(l.length){jive.conc.nextTick(function(){l.click()})}}};g.getEmbeddedExperienceToShowOnLoad=function(){if(typeof this.embeddedExperienceToShowOnLoad==="undefined"){this.embeddedExperienceToShowOnLoad="";var l=/^#([a-zA-Z0-9_-]+)$/.exec(window.location.hash||"");if(!l){l=/[?&]ee=([a-zA-Z0-9_-]+)(&|$)/.exec(window.location.search)}this.embeddedExperienceToShowOnLoad=l?l[1]:null}return this.embeddedExperienceToShowOnLoad};g.buildEmbedContext=function(q){var l={};var r=q.attr("__view")||q.attr("__context")?"embed":q.attr("href")?"url":"none";switch(r){case"embed":var s=q.attr("__view")||"embedded";l.target={type:"embed",view:s};var p=q.attr("__context");if(p){l.target.context=JSON.parse(p)}break;case"url":l.target={type:"url",url:q.attr("href")};break}var o=q.hasClass("jive-link-app-preview")?"image":"text";switch(o){case"image":var m=q.find("> img");l.display={type:"image",previewImage:m.attr("src")};var n=m.attr("title");if(n){l.display.label=n}break;case"text":l.display={type:"text",label:q.text()||""};if(q.hasClass("jive-link-app-icon")){l.display.icon=q.attr("__icon")}break}l.actionId=q.attr("__action_id")||"";l.jive=JSON.parse(q.attr("data-jive-context")||"{}");return l};this.computeAppDimensions=function(q,m){var p=j.computeAppDimensions.call(this,q,m);var n=p.isMaximum,o=p.width,l=p.height;if(n){l=this.getMaximumHeight();o=this.getMaximumWidth()}else{if(o){o=this.boundedWidth(o)}if(l){l=this.boundedHeight(l)}}o=o<this.bounds.minWidth?this.bounds.minWidth:o;l=l<this.bounds.minHeight?this.bounds.minHeight:l;return{height:l,width:o,isMaximum:n}}})});
;
define("jive/app/core_container/views/embedded_view",["jquery","jive/app/core_container/views/appscontainer_view","jive/app/alert/main","jive/app/core_container/navigate_app"],function(d,a,b,c){return a.extend(function(e,g){jive.conc.observable(this);var h={CANVAS:"app.canvas.run"};var i;var f=new c();this.init=function(k,l){var j=this;g.init.call(this,k,l)};this.getActionOriginEnum=function(){return h};this.render=function(k,n,s,j,o){var p=d(n)[0];var r=this;var l=f.addActionQueueItemToViewParams(s);var q=f.getCanvasAppInfoFromUrl();if(q!==null){var m=(l!==null)?l:{};f.setCanvasToken({appInfo:q,view:k.view,params:m})}j=j||{};j.target={};j.target.type="embed";this.renderAppEE_(p,k,j,function(u,t){if(t.error){u.error=t.error;o.call(u);return}i=u;u.jiveData=new JiveSiteData(r,k,l);u.jiveData.setEEContext(j);u.jiveData.setGadgetMetaData(t);var v=d(u.getActiveSiteHolder().getIframeElement());v.attr("width","100%");o.call(u)},null)};this.getRenderedApp=function(){return i&&i.jiveData?i.jiveData.app:null};this.loadAppIframe=function(m,l,j,n){var k=this;k.renderApp_(l,m,function(p){l.jiveData=new JiveSiteData(k,m,j);l.jiveData.setGadgetMetaData(p);var o=d(l.getActiveSiteHolder().getIframeElement());o.attr("width","100%");if(m.marketFeatureAvailable){o.data("hasMarketFeature",true)}else{if(d.browser.msie&&d.browser.version<8){o.attr("scrolling","no")}else{o.removeAttr("scrolling")}o.attr("overflow","auto")}if(n){n(p)}},j)};this.resizeContainerHeight=function(k,j,l){var m=d(l.getActiveSiteHolder().getIframeElement());if(k==="max"){k=this.getMaximumHeight(m)}else{k=Math.min(this.getMaximumHeight(m),k)}m[j?"animate":"css"]({height:(k+"px")},{duration:300,queue:false})};e.getMaximumHeight=function(m){var l=m.parent();var k=Number(/(\d*)/.exec(l.css("max-height"))[1]);var j=d(window).height()-64;return k||j};this.resizeContainerWidth=function(m,j,k){var l=d(k.getActiveSiteHolder().getIframeElement());if(m==="max"){m=this.getMaximumWidth(l)}else{m=Math.min(this.getMaximumWidth(l),m)}l[j?"animate":"css"]({width:(m+"px")},{duration:300,queue:false})};e.getMaximumWidth=function(m){var k=m.parent();var j=Number(/(\d*)/.exec(k.css("max-width"))[1]);var l=d(window).width()-160;return j||l};this.invokeOauthDance=function(l){var j=this;var k=d(".j-app-canvas");d(".j-app-canvas iframe").hide();var p=l.getApp();var o=new b(p,k);var n={appTitle:p.title,code:2060,message:"",creator:"",errorMessage:"",iconSrc:p.iconSrc};var m=o.applyBlock(k,p,n);l.launch_popup(d(m));l.addListener("popup.closed",function(){d(m).remove();d(".j-app-canvas iframe").show();l.invokeCallback()})};e.closeModal=function(){if(this.html&&this.html.find&&this.html.find("a.close")){this.html.find("a.close").click()}}})});
;
define("jive/app/core_container/shared",["jive/app/core_container/models/appscontainer_model","jive/app/core_container/common_container","jive/app/core_container/views/modal_view","jive/app/preferences/models/preferences_model","osapi","gadgets","underscore","jquery","apps/shared/controllers/localexchange"],function(i,e,j,b,h,g,a,c,d){return jive.oo.Class.extend(function(l){jive.conc.observable(this);var n={};var m={};var k={};this.init=function(o){this.options=o=o||{};if((typeof h==="undefined")||(typeof h.container==="undefined")){return}this.model=new i(o);this.commonContainer=e;h.container.GadgetSite.prototype.getActiveGadgetHolder=function(){return this.getActiveSiteHolder()};this.model.initContainerSecurityToken(this.commonContainer);this.modalView=new j(this.commonContainer,o);jQuery.extend(n,this.modalView.getActionOriginEnum());this.sharedRpcRegister();this.rpcRegister();this.initializeEventHandlers(n);d.addListener("app.actionContextAdded",function(p){k={jive:{content:{extraContext:p}}}})};l.sharedRpcRegister=function(){var o=this;this.commonContainer.rpcRegister("actions.bindAction",o.bindAction.bind(o));this.commonContainer.rpcRegister("actions.registerHideCallback",function(p){});this.commonContainer.rpcRegister("actions.registerShowCallback",function(p){});this.commonContainer.rpcRegister("actions.get_actions_by_type",function(p){});this.commonContainer.rpcRegister("actions.get_actions_by_path",function(p){});this.commonContainer.rpcRegister("actions.removeAction",function(p){});this.commonContainer.rpcRegister("actions.runAction",function(p){});this.commonContainer.rpcRegister("set_pref",o.setPref.bind(o));this.commonContainer.rpcRegister("set_title",o.setTitle.bind(o));this.commonContainer.rpcRegister("close_app",o.closeApp.bind(o));this.commonContainer.rpcRegister("send_notification",o.sendNotification.bind(o));this.commonContainer.rpcRegister("request_place_picker",o.initPlacePicker.bind(o));this.commonContainer.rpcRegister("request_user_picker",o.initUserPicker.bind(o));this.commonContainer.rpcRegister("request_unified_picker",o.initUnifiedPicker.bind(o));this.commonContainer.rpcRegister("requestNavigateTo",o.requestNavigateTo.bind(o));this.commonContainer.rpcRegister("request_upload_app_data_media_item",o.requestNavigateTo.bind(o));this.commonContainer.rpcRegister("sample_data",o.sampleData.bind(o));this.commonContainer.rpcRegister("resize_iframe",o.resizeContainerHeight.bind(o));this.commonContainer.rpcRegister("resize_iframe_width",o.resizeContainerWidth.bind(o));this.commonContainer.rpcRegister("scroll_into_view",o.scrollIntoView.bind(o));this.commonContainer.rpcRegister("get_canvas_dimensions",o.getCanvasDimensions.bind(o));this.commonContainer.rpcRegister("ee_gadget_rendered",this.eeGadgetRendered.bind(o));g.rpc.registerDefault(function(p){})};this.initActionLinkContext=function(o){this.actionLinkContext={jive:{content:{type:o.coreAPIType,id:o.id}}}};l.setPref=function(p,u,q,r){var o=p[h.container.GadgetSite.RPC_ARG_KEY];var t=o.jiveData.app;var s=new b();s.setPref(t.instanceAppID,q,r)};l.bindAction=function(p,o){if(m[o.id]){g.rpc.call(m[o.id],"actions.runAction",null,o.id,this.commonContainer.selection.getSelection());delete m[o.id]}};l.bindActionOriginEnum=function(o){jQuery.extend(n,o)};l.handleRunAction=function(q,p){if(window._jive_current_user.anonymous){return}if(window._jive_current_user.partner){if(!window.appUUIDs||window.appUUIDs.indexOf(q.appUUID)<0){return}}var o=this;delete this.postInstallActionRun;this.model.getApp(q.appUUID,q.appInstanceUUID).addCallback(function(r){if(r.url){r.appURL=r.url}else{r.appURL=typeof(q.appURL)!=="undefined"?q.appURL:r.appURL}r.view=q.view;r.actionHeight=(r.heightByView&&r.heightByView[q.view])||r.height;r.actionWidth=(r.widthByView&&r.widthByView[q.view])||r.width;r.actionLabel=q.label;o.runAction(r,q,p)}).addErrback(function(r){if(r&&q&&q.appUUID){if(console){console.log("App URL passed to market:",q.url)}o.handleMarketContext({experience:"marketapp",appUUID:q.appUUID,embeddedID:q.embeddedID,isDevelopmentApp:q.isDevelopment||false,alternateUrl:q.url});o.postInstallActionRun={actionInfo:q,origin:p}}})};l.runAction=function(r,q,o){var p=this.setSelection(q,o);this.modalView.render(r,q,p,function(s){var t=s.getActiveSiteHolder();if(t){m[q.actionId]=t.getIframeId()}})};l.setSelection=function(q,o){var p;switch(o){case n.CONTENT:p=this.initSelection(k);break;case n.LINK:p=this.initSelection(k);break;case n.RTE:p=this.determineContainerContext();p.jive.rte=this.determineRTEContext();if(q.currentArtifact){c.extend(p,q.currentArtifact)}p.actionId=q.actionId;break;case n.PROFILE:p=this.initSelection(k);p.jive.content.type=q.selectionType;p.jive.content.id=q.selectionID;break}this.commonContainer.selection.setSelection(p);return p};l.initSelection=function(o){return c.extend(true,{},this.actionLinkContext,o)};l.initPlacePicker=function(q,p){var o=q[h.container.GadgetSite.RPC_ARG_KEY];o.jiveData.mvcView.initPlacePicker(p,q.callback)};l.initUserPicker=function(q,p){var o=q[h.container.GadgetSite.RPC_ARG_KEY];o.jiveData.mvcView.initUserPicker(p,q.callback)};l.initUnifiedPicker=function(q,p){var o=q[h.container.GadgetSite.RPC_ARG_KEY];o.jiveData.mvcView.initUnifiedPicker(p,q.callback)};l.requestNavigateTo=function(q,o,r,s){var p=q[h.container.GadgetSite.RPC_ARG_KEY];p.jiveData.app.view=o;p.jiveData.mvcView.requestNavigateTo(p.jiveData.app,p,o,r,s)};l.setTitle=function(p,r){var o=p[h.container.GadgetSite.RPC_ARG_KEY];var q=o.jiveData.app;o.jiveData.mvcView.setTitle(r)};l.scheduleModalClose=function(o,p){jive.conc.nextTick(function(){var q=function(){o.closeModal(p)};if(jive.Navbar.Menu.Apps.whenAnimationStarts){jive.Navbar.Menu.Apps.whenAnimationStarts().always(q)}else{q()}if(jive.Navbar.Menu.Apps.whenAnimationEnds){jive.Navbar.Menu.Apps.whenAnimationEnds()}})};l.closeApp=function(r,q){var p=r[h.container.GadgetSite.RPC_ARG_KEY];var o=p.jiveData.mvcView;if(p.jiveData.lightWeightApp===true){if(typeof(q.data)!=="undefined"&&this.appActionDataPromise){this.appActionDataPromise.resolve(q.data)}else{if(this.appActionDataPromise){this.appActionDataPromise.reject()}}}else{if(typeof(q.data)!=="undefined"&&this.appActionDataPromise){var t=this;require(["jive/app/rte/artifacts"],function(u){new u().makeArtifactURLsAbsolute(q.data,p.jiveData.app);t.appActionDataPromise.resolve(q.data,r)})}if(typeof(q.navigateTo)!=="undefined"){if(/^http(s)?\:\/\//i.test(q.navigateTo)){var s=g.io.getProxyUrl().split("?")[0].replace(/\/gadgets\/proxy/,"");if(!q.navigateTo.startsWith(s)){console.error("Error: Unable to navigation to external URL: "+q.navigateTo);delete q.navigateTo}}}}l.scheduleModalClose(o,q)};l.sendNotification=function(s,r){var q=s?s[h.container.GadgetSite.RPC_ARG_KEY]:null;r=r||{};if(typeof(r.message)!=="undefined"){if(typeof(r.severity)!=="undefined"){r.severity=r.severity.toLowerCase();if(!(r.severity in {error:1,info:1,success:1})){throw"Invalid severity: must be 'error', 'info' or 'success'"}}}if(q){var o=q.jiveData.mvcView;o.sendNotification(r)}else{r=r||{};var t=r.message;var p=r.severity||"info";if(typeof(t)!="undefined"){c("<p/>").html(t).message({style:p})}}};this.preCacheAppResources=function(q){var o=q.appUUID;var p=encodeURIComponent(q.appURL);c("body").append('<iframe src="'+jive.app.url({path:"/gadgets/concatresources"})+"?appId="+o+"&gadget="+p+'" width="1px" height="1px"></iframe>')};l.eeGadgetRendered=function(q){var p=q[h.container.GadgetSite.RPC_ARG_KEY];if(p){var s=p.currentGadgetHolder_.renderParams_;var r=s.eeDataModel;return r?r.context:null}else{var o=this.modalView.getEmbeddedContext("latest");if(o){return o}else{return{}}}};l.resizeContainerHeight=function(q,o){var p=q[h.container.GadgetSite.RPC_ARG_KEY];if(!p){return}p.jiveData.mvcView.resizeContainerHeight(o,true,p)};l.resizeContainerWidth=function(p,q){var o=p[h.container.GadgetSite.RPC_ARG_KEY];if(!o){return}o.jiveData.mvcView.resizeContainerWidth(q,true,o);if(p.callback){p.callback.call()}};l.scrollIntoView=function(p){var o=p[h.container.GadgetSite.RPC_ARG_KEY];var r=p.f;var q=p.a[0]||{};o.jiveData.mvcView.scrollIntoView(r,q)};l.getCanvasDimensions=function(r){var q=c(window);var p=q.width();var s=q.height();var t=c("#"+r.f);var o=t.parents(".js-app-chrome");if(o.length){p-=(o.outerWidth()-t.innerWidth());s-=(o.outerHeight()-t.innerHeight())}r.callback({width:p,height:s})};this.renderEmbeddedView=function(C){var p={};var z=r(C.url);var A="http://127.127.127.127:127/resources/com/jivesoftware/community/integration/synthetic/app/impl/app.xml?id="+C.objectID+"&type="+C.objectType+"&proxyURL="+encodeURIComponent(C.url)+"&t="+(new Date()).getTime();var s={instanceAppID:z,developmentApp:false,title:"[lightweight app]",displayTitle:"[lightweight app]",row:0,column:0,state:200,height:0,width:0,heightByView:{},widthByView:{},userPrefs:{},systemSettingsAvailable:false,configurationAvailable:false,configurationError:false,aboutViewAvailable:false,userPrefsAvailable:false,marketFeatureAvailable:false,locallyManaged:false,blockedAppInstance:false,blockingAlerts:[],nonblockingAlerts:[],url:A,id:z};var x=String(C.instanceId||"0");var y=(C.container&&C.container.type)||0;var v=(C.container&&C.container.id)||0;var q=(C.container&&C.container.name)||"";var w=C.userId||0;var B=this.renderEmbeddedViewImpl(s,C.domElement,{container:{type:y,id:v,name:q},identifiers:[{name:"jive",value:x},{name:"viewer",value:x+":"+w},{name:"container",value:x+":"+y+","+v}],data:C.context||{},global:C.global||{},other:{definitions:C.relatedTiles||[]}},p);var o;for(var u=0,t=C.relatedTiles.length;u<t;u++){o=C.relatedTiles[u].name;p[o]=c.Callbacks()}B.data=p;return B;function r(F){var E=0;for(var D=0;D<F.length;D++){E=(31*E+F.charCodeAt(D))&-1}return E}};l.renderEmbeddedViewImpl=function(o,t,r,s){var q=this;var p=a.pluck(r.other.definitions,"name");this.appActionDataPromise=c.Deferred();o.view=o.view||"embedded.renderDataBlock";require(["jive/app/core_container/views/embedded_view","shindig"],function(u,v){l.loadEmbeddedView(q,u);q.model.getAuthToken().then(function(){q.model.cacheApp(o,true);q.embededView.render(o,t,null,f(r),function(){if(t&&this.error&&this.error.message){t.html(this.error.message)}if(this.jiveData&&o.title=="[lightweight app]"){this.jiveData.lightWeightApp=true;this.jiveData.sampleDataCallback=function(w,x){if(p.indexOf(w)>-1){s[w].fire(f(x))}}}})},function(){window.location.reload()})});return this.appActionDataPromise.promise().then(f)};l.loadEmbeddedView=function(o,p){if(typeof(o.embededView)=="undefined"){o.embededView=new p(o.commonContainer,{});this.bindActionOriginEnum(o.embededView.getActionOriginEnum());o.embededView.addListener("app.services.show",function(q){if(o.servicesView&&o.servicesView.isActive()){return}o.servicesView=new AppServicesView(q,o.commonContainer,o.options);o.servicesView.addListener("app.reload",function(){o.reloadApp()})});o.embededView.addListener("app.embedded.modal.close",function(){delete o.servicesView;if(o.credentialsView){o.credentialsView.cleanup();delete o.credentialsView}o.servicesView=null;o.credentialsView=null;o.oauthView=null})}};l.sampleData=function(p,u){var o=p[h.container.GadgetSite.RPC_ARG_KEY];var t=u&&u.data;if(t&&typeof o.jiveData.sampleDataCallback==="function"){var r,s;for(var q=0;q<t.length;q+=1){if(t&&typeof t==="object"){r=t[q].name;s=t[q].data;o.jiveData.sampleDataCallback(r,s)}}}if(p.callback){p.callback()}}});function f(k){return JSON.parse(JSON.stringify(k))}});
;
define("jive/app/core_container/models/rtc_model",{rtcViews:{}});
;
define("jive/app/core_container/tile_app",["jive/app/core_container/shared","osapi","gadgets","jquery"],function(d,c,a,b){return d.extend(function(e){e.rpcRegister=function(){};e.initializeEventHandlers=function(g){var f=this;b.each(g,function(i,h){f.modalView.addListener(h,function(j){f.handleRunAction(j,h)})});this.modalView.addListener("app.services.show",function(h){if(f.servicesView&&f.servicesView.isActive()){return}if(f.servicesView){delete f.servicesView}if(h){f.model.getApp(h).addCallback(function(i){f.servicesView=new AppServicesView(i,f.commonContainer,f.options);f.servicesView.addListener("app.reload",function(){f.reloadApp()});f.model.getAppsMarketApp().addCallback(function(j){f.servicesView.setMarketApp(j);f.servicesView.addListener("app.services.close",function(){f.modalView.destroySettings();if(i.developerModel){f.modalView.setSparkline(i.developerModel.getMonitorState())}});f.modalView.invokeSettings(f.servicesView)})})}});this.modalView.addListener("app.chrome.close",function(){delete f.servicesView;if(f.credentialsView){f.credentialsView.cleanup();delete f.credentialsView}f.servicesView=null;f.credentialsView=null;f.oauthView=null});b(document).ready(function(){f.modalView.documentReady()})}})});
;
